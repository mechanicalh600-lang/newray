import{bm as F,bn as X,V as Y,bo as q,C as G,bp as J,r as d,aK as Z,s as U,j as e,e as ee,aE as re,a6 as I,u as ae,h as O,a4 as te,bj as se,X as de,aH as ne,F as oe,ab as le}from"./index-Ba5jVD6p.js";import{I as ce}from"./info-CFSfHgcC.js";import{R as K,B as E,C as V,X as B,Y as $,T as H,w as W,a as T}from"./BarChart-CG56lHO5.js";import{c as ie}from"./reportTemplates-DFawh_qo.js";import{A as ge}from"./arrow-left-D4pnEk66.js";const A=[{id:1,label:"اطلاعات گزارش",icon:ce},{id:2,label:"خوراک",icon:F},{id:3,label:"تولید",icon:X},{id:4,label:"باطله",icon:Y},{id:5,label:"توقفات",icon:q},{id:6,label:"دسترسی تجهیزات",icon:G},{id:7,label:"ورود خروج",icon:J}],D=["فروردین","اردیبهشت","خرداد","تیر","مرداد","شهریور","مهر","آبان","آذر","دی","بهمن","اسفند"],be=({reportDate:b,onDateChange:M,budgetData:n,onBudgetChange:m,user:l})=>{const[k,y]=d.useState(""),[x,S]=d.useState([]),[z,_]=d.useState(!1),[p,R]=d.useState(-1);d.useEffect(()=>{if(b){const r=Z(b);r&&y(["یکشنبه","دوشنبه","سه‌شنبه","چهارشنبه","پنج‌شنبه","جمعه","شنبه"][r.getDay()]);const a=b.split("/");if(a.length===3){const s=parseInt(a[1])-1;R(s);const o=parseInt(a[0]);C(o)}}},[b]),d.useEffect(()=>{if(x.length>0&&p!==-1){const r=D[p],a=x.find(s=>s.month===r);a&&m({feedUsage:a.feed_usage!==null?String(a.feed_usage):"",feedDevPercent:a.feed_dev_percent!==null?String(a.feed_dev_percent):"100",prodUsage:a.prod_usage!==null?String(a.prod_usage):"",prodDevPercent:a.prod_dev_percent!==null?String(a.prod_dev_percent):"100"})}},[x,p]);const C=async r=>{_(!0);try{const{data:a,error:s}=await U.from("production_plans").select("*").eq("year",r);if(!s&&a){const o=a.sort((c,g)=>D.indexOf(c.month)-D.indexOf(g.month));S(o)}else S([])}catch(a){console.error("Plan fetch error:",a),S([])}finally{_(!1)}},N=(r,a)=>{const s=parseFloat(a);a!==""&&s<0||m({...n,[r]:a})},w=(r,a)=>{if(!r||!a)return 0;const s=parseFloat(r),o=parseFloat(a);return s*(o/100)},f=(r,a)=>{const s=a-r;if(s===0)return e.jsx("span",{className:"text-gray-500 font-bold",children:"0"});const o=s>0,c=o?"text-green-600":"text-red-600",g=o?"+":"";return e.jsxs("span",{className:`${c} font-black text-sm`,dir:"ltr",children:[g,Math.round(s).toLocaleString()]})},L=x.map(r=>{const a=D.indexOf(r.month)===p,s=a?parseFloat(n.feedUsage||"0"):Number(r.feed_usage||0),o=a?parseFloat(n.feedDevPercent||"100"):Number(r.feed_dev_percent||100),c=s*(o/100),g=a?parseFloat(n.prodUsage||"0"):Number(r.prod_usage||0),u=a?parseFloat(n.prodDevPercent||"100"):Number(r.prod_dev_percent||100),P=g*(u/100);return{name:r.month,"برنامه خوراک":Number(r.feed_plan||0),"خوراک نهایی":c,"برنامه تولید":Number(r.prod_plan||0),"تولید نهایی":P}});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-xl border border-gray-200 dark:border-gray-700 shadow-sm flex items-center gap-4",children:[e.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-3 rounded-full",children:e.jsx(ee,{className:"w-6 h-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-gray-500 block mb-1",children:"کاربر ثبت کننده"}),e.jsx("span",{className:"font-bold text-gray-800 dark:text-white",children:(l==null?void 0:l.fullName)||"ناشناس"})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-xl border border-gray-200 dark:border-gray-700 shadow-sm flex items-center gap-4",children:[e.jsx("div",{className:"bg-orange-50 dark:bg-orange-900/20 p-3 rounded-full",children:e.jsx(re,{className:"w-6 h-6 text-orange-600"})}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-gray-500 block mb-1",children:"روز هفته"}),e.jsx("span",{className:"font-bold text-gray-800 dark:text-white",children:k||"---"})]})]}),e.jsx("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-xl border border-gray-200 dark:border-gray-700 shadow-sm",children:e.jsx(I,{label:"تاریخ گزارش",value:b,onChange:M})})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700",children:[e.jsx("h3",{className:"font-bold text-lg mb-4 text-blue-600 border-b pb-2 dark:border-gray-700",children:"جدول برنامه و بودجه سالانه"}),e.jsx("div",{className:"overflow-auto max-h-[65vh] pb-4",children:e.jsxs("table",{className:"w-full text-center text-sm border-collapse min-w-[1600px]",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700 text-gray-600 dark:text-gray-200 border-b-2 border-gray-200 dark:border-gray-600 sticky top-0 z-40",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-3 whitespace-nowrap min-w-[140px] sticky right-0 top-0 bg-gray-50 dark:bg-gray-700 z-50 border-l shadow-sm",children:"سال / ماه"}),e.jsx("th",{className:"p-3 whitespace-nowrap sticky top-0 bg-gray-50 dark:bg-gray-700 z-40",children:"روز کل"}),e.jsx("th",{className:"p-3 whitespace-nowrap sticky top-0 bg-gray-50 dark:bg-gray-700 z-40",children:"روز فعال"}),e.jsx("th",{className:"p-3 whitespace-nowrap text-red-500 border-l border-gray-200 sticky top-0 bg-gray-50 dark:bg-gray-700 z-40",children:"روز توقف"}),e.jsx("th",{className:"p-3 whitespace-nowrap bg-blue-100 dark:bg-blue-900/40 text-blue-900 border-r border-blue-200 sticky top-0 z-40",children:"برنامه خوراک"}),e.jsx("th",{className:"p-3 whitespace-nowrap bg-blue-50 dark:bg-blue-900/20 text-blue-800 border-r border-blue-200 sticky top-0 z-40",children:"خوراک مصرفی"}),e.jsx("th",{className:"p-3 whitespace-nowrap bg-blue-50 dark:bg-blue-900/20 text-blue-800 border-r border-blue-200 sticky top-0 z-40",children:"درصد مطابقت"}),e.jsx("th",{className:"p-3 whitespace-nowrap bg-gray-100 dark:bg-gray-600 text-gray-700 dark:text-gray-200 border-r border-blue-200 sticky top-0 z-40",children:"خوراک نهایی"}),e.jsx("th",{className:"p-3 whitespace-nowrap border-l border-gray-200 sticky top-0 bg-gray-50 dark:bg-gray-700 z-40",children:"انحراف مقدار"}),e.jsx("th",{className:"p-3 whitespace-nowrap bg-green-100 dark:bg-green-900/40 text-green-900 border-r border-green-200 sticky top-0 z-40",children:"برنامه تولید"}),e.jsx("th",{className:"p-3 whitespace-nowrap bg-green-50 dark:bg-green-900/20 text-green-800 border-r border-green-200 sticky top-0 z-40",children:"محصول تولیدی"}),e.jsx("th",{className:"p-3 whitespace-nowrap bg-green-50 dark:bg-green-900/20 text-green-800 border-r border-green-200 sticky top-0 z-40",children:"درصد مطابقت"}),e.jsx("th",{className:"p-3 whitespace-nowrap bg-gray-100 dark:bg-gray-600 text-gray-700 dark:text-gray-200 border-r border-green-200 sticky top-0 z-40",children:"تولید نهایی"}),e.jsx("th",{className:"p-3 whitespace-nowrap border-l border-gray-200 sticky top-0 bg-gray-50 dark:bg-gray-700 z-40",children:"انحراف مقدار"})]})}),e.jsx("tbody",{children:z?e.jsx("tr",{children:e.jsx("td",{colSpan:14,className:"p-8 text-gray-400",children:"در حال دریافت اطلاعات برنامه..."})}):x.length>0?x.map(r=>{const a=D.indexOf(r.month)===p,s=a?"bg-yellow-50 dark:bg-yellow-900/10 border-2 border-yellow-400 transform scale-[1.01] shadow-md z-10 relative":"group hover:bg-gray-50 dark:hover:bg-gray-700/50 text-gray-500 opacity-80 hover:opacity-100",o=Math.round(Number(r.feed_plan||0)),c=Math.round(Number(r.prod_plan||0)),g=a?w(n.feedUsage,n.feedDevPercent):w(String(r.feed_usage||0),String(r.feed_dev_percent||100)),u=a?w(n.prodUsage,n.prodDevPercent):w(String(r.prod_usage||0),String(r.prod_dev_percent||100)),P=a?"p-3 border-b dark:border-gray-700 font-bold sticky right-0 border-l z-20 bg-yellow-50 dark:bg-gray-800":"p-3 border-b dark:border-gray-700 font-bold sticky right-0 border-l z-20 bg-white dark:bg-gray-800 group-hover:bg-gray-50 dark:group-hover:bg-gray-700";return e.jsxs("tr",{className:`transition duration-200 ${s}`,children:[e.jsx("td",{className:P,children:e.jsxs("div",{className:"flex justify-between items-center w-full px-2 gap-4",children:[e.jsx("span",{className:"text-right flex-1",children:r.month}),e.jsx("span",{className:"text-gray-400 font-mono text-xs w-10 text-left border-l pl-2 border-gray-300 dark:border-gray-600",children:r.year})]})}),e.jsx("td",{className:"p-3 border-b dark:border-gray-700",children:r.total_days}),e.jsx("td",{className:"p-3 border-b dark:border-gray-700 font-medium text-green-600",children:r.active_days}),e.jsx("td",{className:"p-3 border-b border-l dark:border-gray-700 font-medium text-red-500 bg-red-50/30 dark:bg-red-900/10",children:r.downtime_days||0}),e.jsx("td",{className:"p-3 border-b border-r dark:border-gray-700 bg-blue-100/50 dark:bg-blue-900/30 font-bold text-blue-800",children:o.toLocaleString()}),e.jsx("td",{className:"p-3 border-b border-r dark:border-gray-700 bg-blue-50/30 dark:bg-blue-900/10",children:a?e.jsx("input",{type:"number",className:"w-24 p-1.5 text-center border border-blue-300 rounded bg-white dark:bg-gray-800 focus:ring-2 focus:ring-blue-500 outline-none",placeholder:"0",value:n.feedUsage,onChange:h=>N("feedUsage",h.target.value)}):e.jsx("span",{children:Number(r.feed_usage||0).toLocaleString()})}),e.jsx("td",{className:"p-3 border-b border-r dark:border-gray-700 bg-blue-50/30 dark:bg-blue-900/10",children:a?e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx("input",{type:"number",className:"w-16 p-1.5 text-center border border-blue-300 rounded bg-white dark:bg-gray-800 focus:ring-2 focus:ring-blue-500 outline-none",placeholder:"100",value:n.feedDevPercent,onChange:h=>N("feedDevPercent",h.target.value)}),e.jsx("span",{className:"text-xs text-gray-500",children:"%"})]}):e.jsxs("span",{children:[r.feed_dev_percent||100,"%"]})}),e.jsx("td",{className:"p-3 border-b border-r dark:border-gray-700 bg-gray-100 dark:bg-gray-600 font-bold",children:Math.round(g).toLocaleString()}),e.jsx("td",{className:"p-3 border-b border-l dark:border-gray-700",children:f(o,g)}),e.jsx("td",{className:"p-3 border-b border-r dark:border-gray-700 bg-green-100/50 dark:bg-green-900/30 font-bold text-green-800",children:c.toLocaleString()}),e.jsx("td",{className:"p-3 border-b border-r dark:border-gray-700 bg-green-50/30 dark:bg-green-900/10",children:a?e.jsx("input",{type:"number",className:"w-24 p-1.5 text-center border border-green-300 rounded bg-white dark:bg-gray-800 focus:ring-2 focus:ring-green-500 outline-none",placeholder:"0",value:n.prodUsage,onChange:h=>N("prodUsage",h.target.value)}):e.jsx("span",{children:Number(r.prod_usage||0).toLocaleString()})}),e.jsx("td",{className:"p-3 border-b border-r dark:border-gray-700 bg-green-50/30 dark:bg-green-900/10",children:a?e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx("input",{type:"number",className:"w-16 p-1.5 text-center border border-green-300 rounded bg-white dark:bg-gray-800 focus:ring-2 focus:ring-green-500 outline-none",placeholder:"100",value:n.prodDevPercent,onChange:h=>N("prodDevPercent",h.target.value)}),e.jsx("span",{className:"text-xs text-gray-500",children:"%"})]}):e.jsxs("span",{children:[r.prod_dev_percent||100,"%"]})}),e.jsx("td",{className:"p-3 border-b border-r dark:border-gray-700 bg-gray-100 dark:bg-gray-600 font-bold",children:Math.round(u).toLocaleString()}),e.jsx("td",{className:"p-3 border-b border-l dark:border-gray-700",children:f(c,u)})]},r.id)}):e.jsx("tr",{children:e.jsx("td",{colSpan:14,className:"p-8 text-gray-400 bg-gray-50 dark:bg-gray-900/50",children:"برای سال جاری برنامه تولیدی تعریف نشده است."})})})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 animate-fadeIn delay-100",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700",children:[e.jsxs("h3",{className:"font-bold text-center mb-4 text-blue-600 dark:text-blue-400 flex items-center justify-center gap-2",children:[e.jsx("span",{className:"w-3 h-3 bg-blue-600 rounded-full inline-block"})," مقایسه برنامه و عملکرد خوراک"]}),e.jsx("div",{className:"h-80",children:e.jsx(K,{width:"100%",height:"100%",children:e.jsxs(E,{data:L,margin:{top:10,right:10,left:10,bottom:30},children:[e.jsx(V,{strokeDasharray:"3 3",vertical:!1,strokeOpacity:.5}),e.jsx(B,{dataKey:"name",tick:{fontSize:10,fill:"#6b7280"},interval:0,angle:-45,textAnchor:"end",height:70,tickMargin:10}),e.jsx($,{tick:{fontSize:10},tickFormatter:r=>r>=1e3?`${(r/1e3).toFixed(0)}k`:r,width:40,tickMargin:5}),e.jsx(H,{contentStyle:{borderRadius:"8px",border:"none",boxShadow:"0 4px 6px rgba(0,0,0,0.1)"},formatter:r=>r.toLocaleString()}),e.jsx(W,{wrapperStyle:{fontSize:"12px",paddingTop:"10px"}}),e.jsx(T,{dataKey:"برنامه خوراک",fill:"#fb923c",radius:[4,4,0,0],name:"برنامه"}),e.jsx(T,{dataKey:"خوراک نهایی",fill:"#1d4ed8",radius:[4,4,0,0],name:"عملکرد"})]})})})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700",children:[e.jsxs("h3",{className:"font-bold text-center mb-4 text-green-600 dark:text-green-400 flex items-center justify-center gap-2",children:[e.jsx("span",{className:"w-3 h-3 bg-green-600 rounded-full inline-block"})," مقایسه برنامه و عملکرد تولید"]}),e.jsx("div",{className:"h-80",children:e.jsx(K,{width:"100%",height:"100%",children:e.jsxs(E,{data:L,margin:{top:10,right:10,left:10,bottom:30},children:[e.jsx(V,{strokeDasharray:"3 3",vertical:!1,strokeOpacity:.5}),e.jsx(B,{dataKey:"name",tick:{fontSize:10,fill:"#6b7280"},interval:0,angle:-45,textAnchor:"end",height:70,tickMargin:10}),e.jsx($,{tick:{fontSize:10},tickFormatter:r=>r>=1e3?`${(r/1e3).toFixed(0)}k`:r,width:40,tickMargin:5}),e.jsx(H,{contentStyle:{borderRadius:"8px",border:"none",boxShadow:"0 4px 6px rgba(0,0,0,0.1)"},formatter:r=>r.toLocaleString()}),e.jsx(W,{wrapperStyle:{fontSize:"12px",paddingTop:"10px"}}),e.jsx(T,{dataKey:"برنامه تولید",fill:"#c084fc",radius:[4,4,0,0],name:"برنامه"}),e.jsx(T,{dataKey:"تولید نهایی",fill:"#15803d",radius:[4,4,0,0],name:"عملکرد"})]})})})]})]})]})},xe=({reportDate:b})=>e.jsxs("div",{className:"p-6 bg-white dark:bg-gray-800 rounded-xl shadow-sm border dark:border-gray-700 flex flex-col items-center justify-center min-h-[400px] text-gray-400",children:[e.jsx(F,{className:"w-16 h-16 mb-4 opacity-20"}),e.jsx("h3",{className:"text-xl font-bold mb-2",children:"اطلاعات خوراک"}),e.jsx("p",{className:"text-sm",children:"این بخش در حال توسعه است. (اطلاعات روزانه خوراک اینجا نمایش داده می‌شود)"})]}),pe=()=>e.jsxs("div",{className:"p-6 bg-white dark:bg-gray-800 rounded-xl shadow-sm border dark:border-gray-700 flex flex-col items-center justify-center min-h-[400px] text-gray-400",children:[e.jsx(X,{className:"w-16 h-16 mb-4 opacity-20"}),e.jsx("h3",{className:"text-xl font-bold mb-2",children:"اطلاعات تولید"}),e.jsx("p",{className:"text-sm",children:"این بخش در حال توسعه است. (آمار تولید کنسانتره)"})]}),he=()=>e.jsxs("div",{className:"p-6 bg-white dark:bg-gray-800 rounded-xl shadow-sm border dark:border-gray-700 flex flex-col items-center justify-center min-h-[400px] text-gray-400",children:[e.jsx(Y,{className:"w-16 h-16 mb-4 opacity-20"}),e.jsx("h3",{className:"text-xl font-bold mb-2",children:"اطلاعات باطله"}),e.jsx("p",{className:"text-sm",children:"این بخش در حال توسعه است. (آمار باطله کارخانه)"})]}),me=()=>e.jsxs("div",{className:"p-6 bg-white dark:bg-gray-800 rounded-xl shadow-sm border dark:border-gray-700 flex flex-col items-center justify-center min-h-[400px] text-gray-400",children:[e.jsx(q,{className:"w-16 h-16 mb-4 opacity-20"}),e.jsx("h3",{className:"text-xl font-bold mb-2",children:"توقفات"}),e.jsx("p",{className:"text-sm",children:"این بخش در حال توسعه است. (گزارش توقفات خطوط)"})]}),ue=()=>e.jsxs("div",{className:"p-6 bg-white dark:bg-gray-800 rounded-xl shadow-sm border dark:border-gray-700 flex flex-col items-center justify-center min-h-[400px] text-gray-400",children:[e.jsx(G,{className:"w-16 h-16 mb-4 opacity-20"}),e.jsx("h3",{className:"text-xl font-bold mb-2",children:"دسترس‌پذیری"}),e.jsx("p",{className:"text-sm",children:"این بخش در حال توسعه است. (شاخص‌های PA/UA)"})]}),ye=()=>e.jsxs("div",{className:"p-6 bg-white dark:bg-gray-800 rounded-xl shadow-sm border dark:border-gray-700 flex flex-col items-center justify-center min-h-[400px] text-gray-400",children:[e.jsx(J,{className:"w-16 h-16 mb-4 opacity-20"}),e.jsx("h3",{className:"text-xl font-bold mb-2",children:"لجستیک"}),e.jsx("p",{className:"text-sm",children:"این بخش در حال توسعه است. (آمار ورود و خروج)"})]}),ve=({user:b})=>{const M=ae(),[n,m]=d.useState("LIST"),[l,k]=d.useState(1),[y,x]=d.useState(O()),[S,z]=d.useState(!1),[_,p]=d.useState([]),[R,C]=d.useState([]),[N,w]=d.useState([]),[f,L]=d.useState(""),[r,a]=d.useState(""),[s,o]=d.useState("ALL"),[c,g]=d.useState({feedUsage:"",feedDevPercent:"100",prodUsage:"",prodDevPercent:"100"});d.useEffect(()=>{ie("productionreport","قالب پیش فرض گزارش تولید"),u()},[n]),d.useEffect(()=>{let t=_;f&&(t=t.filter(i=>i.date>=f)),r&&(t=t.filter(i=>i.date<=r)),s!=="ALL"&&(t=t.filter(i=>i.status===s)),C(t)},[f,r,s,_]);const u=async()=>{z(!0);try{const{data:t,error:i}=await U.from("production_reports").select("*").order("created_at",{ascending:!1});if(i)throw i;const j=(t||[]).map(v=>({id:v.id,code:v.tracking_code,date:v.report_date,totalProd:Number(v.total_production||0),status:v.status||"تکمیل شده",raw:v}));p(j),C(j)}catch{p([]),C([])}finally{z(!1)}},P=async t=>{p(i=>i.filter(j=>!t.includes(j.id))),alert("حذف شد (شبیه‌سازی)")},h=[{header:"کد گزارش",accessor:t=>e.jsx("span",{className:"font-mono font-bold",children:t.code}),sortKey:"code"},{header:"تاریخ",accessor:t=>t.date,sortKey:"date"},{header:"تولید کل (تن)",accessor:t=>t.totalProd.toLocaleString(),sortKey:"totalProd"},{header:"وضعیت",accessor:t=>t.status,sortKey:"status"}],Q=e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx("div",{children:e.jsx(I,{label:"از تاریخ",value:f,onChange:L})}),e.jsx("div",{children:e.jsx(I,{label:"تا تاریخ",value:r,onChange:a})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:"وضعیت"}),e.jsxs("select",{className:"w-full p-2 border rounded-lg",value:s,onChange:t=>o(t.target.value),children:[e.jsx("option",{value:"ALL",children:"همه"}),e.jsx("option",{value:"تکمیل شده",children:"تکمیل شده"}),e.jsx("option",{value:"در حال انجام",children:"در حال انجام"})]})]})]});return n==="LIST"?e.jsx(te,{title:"گزارش جامع تولید",icon:F,data:R,isLoading:S,columns:h,onAdd:()=>{x(O()),m("FORM"),k(1)},onReload:u,onDelete:P,selectedIds:N,onSelect:w,filterContent:Q,onViewDetails:()=>m("FORM"),onEdit:()=>m("FORM"),onPrint:t=>se(M,"productionreport",t),exportName:"ProductionReports"}):e.jsxs("div",{className:"max-w-6xl mx-auto pb-24",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6 sticky top-0 bg-gray-50 dark:bg-gray-900 z-20 py-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(F,{className:"w-8 h-8 text-primary"}),e.jsx("h1",{className:"text-2xl font-bold",children:"ثبت گزارش تولید روزانه"})]}),e.jsx("button",{onClick:()=>m("LIST"),className:"p-2 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-full",children:e.jsx(de,{className:"w-6 h-6"})})]}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm mb-6 sticky top-16 z-10 border border-gray-200 dark:border-gray-700 overflow-x-auto",children:e.jsx("div",{className:"flex min-w-max",children:A.map(t=>e.jsxs("button",{onClick:()=>k(t.id),className:`flex-1 py-4 px-6 flex items-center justify-center gap-2 text-sm font-bold transition-all border-b-4 ${l===t.id?"border-primary text-primary bg-primary/5":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[e.jsx(t.icon,{className:"w-5 h-5"})," ",t.label]},t.id))})}),e.jsxs("form",{onSubmit:t=>t.preventDefault(),children:[l===1&&e.jsx(be,{reportDate:y,onDateChange:x,budgetData:c,onBudgetChange:g,user:b}),l===2&&e.jsx(xe,{reportDate:y}),l===3&&e.jsx(pe,{}),l===4&&e.jsx(he,{}),l===5&&e.jsx(me,{}),l===6&&e.jsx(ue,{}),l===7&&e.jsx(ye,{}),e.jsxs("div",{className:"flex items-center justify-between pt-6 border-t dark:border-gray-700 mt-6 pb-20",children:[e.jsxs("button",{type:"button",onClick:()=>k(t=>Math.max(1,t-1)),disabled:l===1,className:"px-6 py-3 rounded-xl border hover:bg-gray-100 disabled:opacity-50 transition flex items-center gap-2",children:[e.jsx(ne,{className:"w-5 h-5"})," مرحله قبل"]}),l===A.length?e.jsxs("button",{type:"button",onClick:async()=>{if(!y){alert("تاریخ گزارش الزامی است.");return}const i={tracking_code:await le("PR-"),report_date:y,total_production:Number(c.prodUsage||0),status:"تکمیل شده",full_data:{reportDate:y,budgetData:c,createdBy:b.fullName}},{error:j}=await U.from("production_reports").insert([i]);if(j){alert(`خطا در ثبت: ${j.message}`);return}alert("ذخیره شد"),await u(),m("LIST")},className:"bg-primary text-white px-8 py-3 rounded-xl shadow-lg hover:bg-red-800 transition flex items-center gap-2 transform active:scale-95 font-bold text-lg",children:[e.jsx(oe,{className:"w-6 h-6"})," ذخیره گزارش"]}):e.jsxs("button",{type:"button",onClick:()=>k(t=>Math.min(A.length,t+1)),className:"px-8 py-3 rounded-xl shadow transition flex items-center gap-2 font-bold bg-blue-600 text-white hover:bg-blue-700",children:["مرحله بعد ",e.jsx(ge,{className:"w-5 h-5"})]})]})]})]})};export{ve as ProductionReport,ve as default};
