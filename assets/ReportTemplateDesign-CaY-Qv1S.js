import{c as ne,aT as A,q as Pa,r as S,j as e,a4 as Sa,aU as Tt,aH as Ta,am as xe,aM as me,aq as Ra,aV as Rt,aL as Oa,aW as Ot,F as Ea,aX as _a,aY as La,g as Da,aZ as Ma,a as Ia,a_ as Ba,a$ as $a,b0 as Fa,Z as za,I as pt,aG as Ha,s as Et,b1 as Ga,aI as Ie,V as _t,b2 as Ua}from"./index-Ba5jVD6p.js";import{e as Ka,d as Lt,g as Wa,s as Va,a as Xa,b as qa}from"./reportTemplates-DFawh_qo.js";import{f as te,c as Oe,p as $e,i as ke,D as Ht,L as Ae,A as Gt,b as ce,d as ft,e as Ut,G as Kt,g as tt,l as Ya,h as at,m as Je,j as Re,k as ut,n as Ja,o as Za,u as Qa,q as Dt,r as Wt,s as er,X as Qe,Y as et,t as tr,R as ar,B as rr,C as ht,T as Be,a as sr,v as nr,w as or}from"./BarChart-CG56lHO5.js";import{P as lr,a as Vt,b as Xt,c as ir,d as cr}from"./PieChart-D5hrt51y.js";import{L as dr,a as pr}from"./LineChart-BSiQnK8R.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xt=ne("AlignCenter",[["line",{x1:"21",x2:"3",y1:"6",y2:"6",key:"1fp77t"}],["line",{x1:"17",x2:"7",y1:"12",y2:"12",key:"rsh8ii"}],["line",{x1:"19",x2:"5",y1:"18",y2:"18",key:"1t0tuv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mt=ne("AlignLeft",[["line",{x1:"21",x2:"3",y1:"6",y2:"6",key:"1fp77t"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}],["line",{x1:"17",x2:"3",y1:"18",y2:"18",key:"1awlsn"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gt=ne("AlignRight",[["line",{x1:"21",x2:"3",y1:"6",y2:"6",key:"1fp77t"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}],["line",{x1:"21",x2:"7",y1:"18",y2:"18",key:"1g9eri"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mt=ne("BarChart",[["line",{x1:"12",x2:"12",y1:"20",y2:"10",key:"1vz5eb"}],["line",{x1:"18",x2:"18",y1:"20",y2:"4",key:"cun8e5"}],["line",{x1:"6",x2:"6",y1:"20",y2:"16",key:"hq0ia6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ur=ne("Bold",[["path",{d:"M14 12a4 4 0 0 0 0-8H6v8",key:"v2sylx"}],["path",{d:"M15 20a4 4 0 0 0 0-8H6v8Z",key:"1ef5ya"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hr=ne("Italic",[["line",{x1:"19",x2:"10",y1:"4",y2:"4",key:"15jd3p"}],["line",{x1:"14",x2:"5",y1:"20",y2:"20",key:"bu0au3"}],["line",{x1:"15",x2:"9",y1:"4",y2:"20",key:"uljnxc"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xr=ne("Ruler",[["path",{d:"M21.3 15.3a2.4 2.4 0 0 1 0 3.4l-2.6 2.6a2.4 2.4 0 0 1-3.4 0L2.7 8.7a2.41 2.41 0 0 1 0-3.4l2.6-2.6a2.41 2.41 0 0 1 3.4 0Z",key:"icamh8"}],["path",{d:"m14.5 12.5 2-2",key:"inckbg"}],["path",{d:"m11.5 9.5 2-2",key:"fmmyf7"}],["path",{d:"m8.5 6.5 2-2",key:"vc6u1g"}],["path",{d:"m17.5 15.5 2-2",key:"wo5hmg"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mr=ne("Sigma",[["path",{d:"M18 7V4H6l6 8-6 8h12v-3",key:"zis8ev"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gr=ne("Table",[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fr=ne("Type",[["polyline",{points:"4 7 4 4 20 4 20 7",key:"1nosan"}],["line",{x1:"9",x2:"15",y1:"20",y2:"20",key:"swin9y"}],["line",{x1:"12",x2:"12",y1:"4",y2:"20",key:"1tx1rr"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const br=ne("Underline",[["path",{d:"M6 4v6a6 6 0 0 0 12 0V4",key:"9kb039"}],["line",{x1:"4",x2:"20",y1:"20",y2:"20",key:"nun2al"}]]);var yr=["cx","cy","innerRadius","outerRadius","gridType","radialLines"];function Fe(r){"@babel/helpers - typeof";return Fe=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(a){return typeof a}:function(a){return a&&typeof Symbol=="function"&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},Fe(r)}function vr(r,a){if(r==null)return{};var o=jr(r,a),s,i;if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(r);for(i=0;i<p.length;i++)s=p[i],!(a.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(r,s)&&(o[s]=r[s])}return o}function jr(r,a){if(r==null)return{};var o={};for(var s in r)if(Object.prototype.hasOwnProperty.call(r,s)){if(a.indexOf(s)>=0)continue;o[s]=r[s]}return o}function fe(){return fe=Object.assign?Object.assign.bind():function(r){for(var a=1;a<arguments.length;a++){var o=arguments[a];for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(r[s]=o[s])}return r},fe.apply(this,arguments)}function It(r,a){var o=Object.keys(r);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(r);a&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),o.push.apply(o,s)}return o}function ze(r){for(var a=1;a<arguments.length;a++){var o=arguments[a]!=null?arguments[a]:{};a%2?It(Object(o),!0).forEach(function(s){Nr(r,s,o[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):It(Object(o)).forEach(function(s){Object.defineProperty(r,s,Object.getOwnPropertyDescriptor(o,s))})}return r}function Nr(r,a,o){return a=wr(a),a in r?Object.defineProperty(r,a,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[a]=o,r}function wr(r){var a=Ar(r,"string");return Fe(a)=="symbol"?a:a+""}function Ar(r,a){if(Fe(r)!="object"||!r)return r;var o=r[Symbol.toPrimitive];if(o!==void 0){var s=o.call(r,a);if(Fe(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(a==="string"?String:Number)(r)}var Cr=function(a,o,s,i){var p="";return i.forEach(function(c,u){var f=$e(o,s,a,c);u?p+="L ".concat(f.x,",").concat(f.y):p+="M ".concat(f.x,",").concat(f.y)}),p+="Z",p},kr=function(a){var o=a.cx,s=a.cy,i=a.innerRadius,p=a.outerRadius,c=a.polarAngles,u=a.radialLines;if(!c||!c.length||!u)return null;var f=ze({stroke:"#ccc"},te(a,!1));return A.createElement("g",{className:"recharts-polar-grid-angle"},c.map(function(g){var N=$e(o,s,i,g),v=$e(o,s,p,g);return A.createElement("line",fe({},f,{key:"line-".concat(g),x1:N.x,y1:N.y,x2:v.x,y2:v.y}))}))},Pr=function(a){var o=a.cx,s=a.cy,i=a.radius,p=a.index,c=ze(ze({stroke:"#ccc"},te(a,!1)),{},{fill:"none"});return A.createElement("circle",fe({},c,{className:Oe("recharts-polar-grid-concentric-circle",a.className),key:"circle-".concat(p),cx:o,cy:s,r:i}))},Sr=function(a){var o=a.radius,s=a.index,i=ze(ze({stroke:"#ccc"},te(a,!1)),{},{fill:"none"});return A.createElement("path",fe({},i,{className:Oe("recharts-polar-grid-concentric-polygon",a.className),key:"path-".concat(s),d:Cr(o,a.cx,a.cy,a.polarAngles)}))},Tr=function(a){var o=a.polarRadius,s=a.gridType;return!o||!o.length?null:A.createElement("g",{className:"recharts-polar-grid-concentric"},o.map(function(i,p){var c=p;return s==="circle"?A.createElement(Pr,fe({key:c},a,{radius:i,index:p})):A.createElement(Sr,fe({key:c},a,{radius:i,index:p}))}))},qt=function(a){var o=a.cx,s=o===void 0?0:o,i=a.cy,p=i===void 0?0:i,c=a.innerRadius,u=c===void 0?0:c,f=a.outerRadius,g=f===void 0?0:f,N=a.gridType,v=N===void 0?"polygon":N,j=a.radialLines,R=j===void 0?!0:j,O=vr(a,yr);return g<=0?null:A.createElement("g",{className:"recharts-polar-grid"},A.createElement(kr,fe({cx:s,cy:p,innerRadius:u,outerRadius:g,gridType:v,radialLines:R},O)),A.createElement(Tr,fe({cx:s,cy:p,innerRadius:u,outerRadius:g,gridType:v,radialLines:R},O)))};qt.displayName="PolarGrid";function Rr(r){return r&&r.length?r[0]:void 0}var Or=Rr,Er=Or;const _r=Pa(Er);var Lr=["key"];function Ee(r){"@babel/helpers - typeof";return Ee=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(a){return typeof a}:function(a){return a&&typeof Symbol=="function"&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},Ee(r)}function Dr(r,a){if(r==null)return{};var o=Mr(r,a),s,i;if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(r);for(i=0;i<p.length;i++)s=p[i],!(a.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(r,s)&&(o[s]=r[s])}return o}function Mr(r,a){if(r==null)return{};var o={};for(var s in r)if(Object.prototype.hasOwnProperty.call(r,s)){if(a.indexOf(s)>=0)continue;o[s]=r[s]}return o}function rt(){return rt=Object.assign?Object.assign.bind():function(r){for(var a=1;a<arguments.length;a++){var o=arguments[a];for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(r[s]=o[s])}return r},rt.apply(this,arguments)}function Bt(r,a){var o=Object.keys(r);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(r);a&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),o.push.apply(o,s)}return o}function W(r){for(var a=1;a<arguments.length;a++){var o=arguments[a]!=null?arguments[a]:{};a%2?Bt(Object(o),!0).forEach(function(s){ge(r,s,o[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):Bt(Object(o)).forEach(function(s){Object.defineProperty(r,s,Object.getOwnPropertyDescriptor(o,s))})}return r}function Ir(r,a){if(!(r instanceof a))throw new TypeError("Cannot call a class as a function")}function $t(r,a){for(var o=0;o<a.length;o++){var s=a[o];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(r,Jt(s.key),s)}}function Br(r,a,o){return a&&$t(r.prototype,a),o&&$t(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r}function $r(r,a,o){return a=st(a),Fr(r,Yt()?Reflect.construct(a,o||[],st(r).constructor):a.apply(r,o))}function Fr(r,a){if(a&&(Ee(a)==="object"||typeof a=="function"))return a;if(a!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return zr(r)}function zr(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function Yt(){try{var r=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Yt=function(){return!!r})()}function st(r){return st=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(o){return o.__proto__||Object.getPrototypeOf(o)},st(r)}function Hr(r,a){if(typeof a!="function"&&a!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(a&&a.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),a&&bt(r,a)}function bt(r,a){return bt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,i){return s.__proto__=i,s},bt(r,a)}function ge(r,a,o){return a=Jt(a),a in r?Object.defineProperty(r,a,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[a]=o,r}function Jt(r){var a=Gr(r,"string");return Ee(a)=="symbol"?a:a+""}function Gr(r,a){if(Ee(r)!="object"||!r)return r;var o=r[Symbol.toPrimitive];if(o!==void 0){var s=o.call(r,a);if(Ee(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(r)}var He=function(r){function a(){var o;Ir(this,a);for(var s=arguments.length,i=new Array(s),p=0;p<s;p++)i[p]=arguments[p];return o=$r(this,a,[].concat(i)),ge(o,"state",{isAnimationFinished:!1}),ge(o,"handleAnimationEnd",function(){var c=o.props.onAnimationEnd;o.setState({isAnimationFinished:!0}),ke(c)&&c()}),ge(o,"handleAnimationStart",function(){var c=o.props.onAnimationStart;o.setState({isAnimationFinished:!1}),ke(c)&&c()}),ge(o,"handleMouseEnter",function(c){var u=o.props.onMouseEnter;u&&u(o.props,c)}),ge(o,"handleMouseLeave",function(c){var u=o.props.onMouseLeave;u&&u(o.props,c)}),o}return Hr(a,r),Br(a,[{key:"renderDots",value:function(s){var i=this.props,p=i.dot,c=i.dataKey,u=te(this.props,!1),f=te(p,!0),g=s.map(function(N,v){var j=W(W(W({key:"dot-".concat(v),r:3},u),f),{},{dataKey:c,cx:N.x,cy:N.y,index:v,payload:N});return a.renderDotItem(p,j)});return A.createElement(Ae,{className:"recharts-radar-dots"},g)}},{key:"renderPolygonStatically",value:function(s){var i=this.props,p=i.shape,c=i.dot,u=i.isRange,f=i.baseLinePoints,g=i.connectNulls,N;return A.isValidElement(p)?N=A.cloneElement(p,W(W({},this.props),{},{points:s})):ke(p)?N=p(W(W({},this.props),{},{points:s})):N=A.createElement(lr,rt({},te(this.props,!0),{onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,points:s,baseLinePoints:u?f:null,connectNulls:g})),A.createElement(Ae,{className:"recharts-radar-polygon"},N,c?this.renderDots(s):null)}},{key:"renderPolygonWithAnimation",value:function(){var s=this,i=this.props,p=i.points,c=i.isAnimationActive,u=i.animationBegin,f=i.animationDuration,g=i.animationEasing,N=i.animationId,v=this.state.prevPoints;return A.createElement(Gt,{begin:u,duration:f,isActive:c,easing:g,from:{t:0},to:{t:1},key:"radar-".concat(N),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(j){var R=j.t,O=v&&v.length/p.length,D=p.map(function(T,G){var M=v&&v[Math.floor(G*O)];if(M){var Z=ce(M.x,T.x),_=ce(M.y,T.y);return W(W({},T),{},{x:Z(R),y:_(R)})}var $=ce(T.cx,T.x),z=ce(T.cy,T.y);return W(W({},T),{},{x:$(R),y:z(R)})});return s.renderPolygonStatically(D)})}},{key:"renderPolygon",value:function(){var s=this.props,i=s.points,p=s.isAnimationActive,c=s.isRange,u=this.state.prevPoints;return p&&i&&i.length&&!c&&(!u||!ft(u,i))?this.renderPolygonWithAnimation():this.renderPolygonStatically(i)}},{key:"render",value:function(){var s=this.props,i=s.hide,p=s.className,c=s.points,u=s.isAnimationActive;if(i||!c||!c.length)return null;var f=this.state.isAnimationFinished,g=Oe("recharts-radar",p);return A.createElement(Ae,{className:g},this.renderPolygon(),(!u||f)&&Ut.renderCallByParent(this.props,c))}}],[{key:"getDerivedStateFromProps",value:function(s,i){return s.animationId!==i.prevAnimationId?{prevAnimationId:s.animationId,curPoints:s.points,prevPoints:i.curPoints}:s.points!==i.curPoints?{curPoints:s.points}:null}},{key:"renderDotItem",value:function(s,i){var p;if(A.isValidElement(s))p=A.cloneElement(s,i);else if(ke(s))p=s(i);else{var c=i.key,u=Dr(i,Lr);p=A.createElement(Ht,rt({},u,{key:c,className:Oe("recharts-radar-dot",typeof s!="boolean"?s.className:"")}))}return p}}])}(S.PureComponent);ge(He,"displayName","Radar");ge(He,"defaultProps",{angleAxisId:0,radiusAxisId:0,hide:!1,activeDot:!0,dot:!1,legendType:"rect",isAnimationActive:!Kt.isSsr,animationBegin:0,animationDuration:1500,animationEasing:"ease"});ge(He,"getComposedData",function(r){var a=r.radiusAxis,o=r.angleAxis,s=r.displayedData,i=r.dataKey,p=r.bandSize,c=o.cx,u=o.cy,f=!1,g=[],N=o.type!=="number"?p??0:0;s.forEach(function(j,R){var O=tt(j,o.dataKey,R),D=tt(j,i),T=o.scale(O)+N,G=Array.isArray(D)?Ya(D):D,M=at(G)?void 0:a.scale(G);Array.isArray(D)&&D.length>=2&&(f=!0),g.push(W(W({},$e(c,u,M,T)),{},{name:O,value:D,cx:c,cy:u,radius:M,angle:T,payload:j}))});var v=[];return f&&g.forEach(function(j){if(Array.isArray(j.value)){var R=_r(j.value),O=at(R)?void 0:a.scale(R);v.push(W(W({},j),{},{radius:O},$e(c,u,O,j.angle)))}else v.push(j)}),{points:g,isRange:f,baseLinePoints:v}});var Ur=["layout","type","stroke","connectNulls","isRange","ref"],Kr=["key"],Zt;function _e(r){"@babel/helpers - typeof";return _e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(a){return typeof a}:function(a){return a&&typeof Symbol=="function"&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},_e(r)}function Qt(r,a){if(r==null)return{};var o=Wr(r,a),s,i;if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(r);for(i=0;i<p.length;i++)s=p[i],!(a.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(r,s)&&(o[s]=r[s])}return o}function Wr(r,a){if(r==null)return{};var o={};for(var s in r)if(Object.prototype.hasOwnProperty.call(r,s)){if(a.indexOf(s)>=0)continue;o[s]=r[s]}return o}function Pe(){return Pe=Object.assign?Object.assign.bind():function(r){for(var a=1;a<arguments.length;a++){var o=arguments[a];for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(r[s]=o[s])}return r},Pe.apply(this,arguments)}function Ft(r,a){var o=Object.keys(r);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(r);a&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),o.push.apply(o,s)}return o}function we(r){for(var a=1;a<arguments.length;a++){var o=arguments[a]!=null?arguments[a]:{};a%2?Ft(Object(o),!0).forEach(function(s){de(r,s,o[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):Ft(Object(o)).forEach(function(s){Object.defineProperty(r,s,Object.getOwnPropertyDescriptor(o,s))})}return r}function Vr(r,a){if(!(r instanceof a))throw new TypeError("Cannot call a class as a function")}function zt(r,a){for(var o=0;o<a.length;o++){var s=a[o];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(r,ta(s.key),s)}}function Xr(r,a,o){return a&&zt(r.prototype,a),o&&zt(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r}function qr(r,a,o){return a=nt(a),Yr(r,ea()?Reflect.construct(a,o||[],nt(r).constructor):a.apply(r,o))}function Yr(r,a){if(a&&(_e(a)==="object"||typeof a=="function"))return a;if(a!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Jr(r)}function Jr(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function ea(){try{var r=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(ea=function(){return!!r})()}function nt(r){return nt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(o){return o.__proto__||Object.getPrototypeOf(o)},nt(r)}function Zr(r,a){if(typeof a!="function"&&a!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(a&&a.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),a&&yt(r,a)}function yt(r,a){return yt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,i){return s.__proto__=i,s},yt(r,a)}function de(r,a,o){return a=ta(a),a in r?Object.defineProperty(r,a,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[a]=o,r}function ta(r){var a=Qr(r,"string");return _e(a)=="symbol"?a:a+""}function Qr(r,a){if(_e(r)!="object"||!r)return r;var o=r[Symbol.toPrimitive];if(o!==void 0){var s=o.call(r,a);if(_e(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(r)}var Ce=function(r){function a(){var o;Vr(this,a);for(var s=arguments.length,i=new Array(s),p=0;p<s;p++)i[p]=arguments[p];return o=qr(this,a,[].concat(i)),de(o,"state",{isAnimationFinished:!0}),de(o,"id",Qa("recharts-area-")),de(o,"handleAnimationEnd",function(){var c=o.props.onAnimationEnd;o.setState({isAnimationFinished:!0}),ke(c)&&c()}),de(o,"handleAnimationStart",function(){var c=o.props.onAnimationStart;o.setState({isAnimationFinished:!1}),ke(c)&&c()}),o}return Zr(a,r),Xr(a,[{key:"renderDots",value:function(s,i,p){var c=this.props.isAnimationActive,u=this.state.isAnimationFinished;if(c&&!u)return null;var f=this.props,g=f.dot,N=f.points,v=f.dataKey,j=te(this.props,!1),R=te(g,!0),O=N.map(function(T,G){var M=we(we(we({key:"dot-".concat(G),r:3},j),R),{},{index:G,cx:T.x,cy:T.y,dataKey:v,value:T.value,payload:T.payload,points:N});return a.renderDotItem(g,M)}),D={clipPath:s?"url(#clipPath-".concat(i?"":"dots-").concat(p,")"):null};return A.createElement(Ae,Pe({className:"recharts-area-dots"},D),O)}},{key:"renderHorizontalRect",value:function(s){var i=this.props,p=i.baseLine,c=i.points,u=i.strokeWidth,f=c[0].x,g=c[c.length-1].x,N=s*Math.abs(f-g),v=Je(c.map(function(j){return j.y||0}));return Re(p)&&typeof p=="number"?v=Math.max(p,v):p&&Array.isArray(p)&&p.length&&(v=Math.max(Je(p.map(function(j){return j.y||0})),v)),Re(v)?A.createElement("rect",{x:f<g?f:f-N,y:0,width:N,height:Math.floor(v+(u?parseInt("".concat(u),10):1))}):null}},{key:"renderVerticalRect",value:function(s){var i=this.props,p=i.baseLine,c=i.points,u=i.strokeWidth,f=c[0].y,g=c[c.length-1].y,N=s*Math.abs(f-g),v=Je(c.map(function(j){return j.x||0}));return Re(p)&&typeof p=="number"?v=Math.max(p,v):p&&Array.isArray(p)&&p.length&&(v=Math.max(Je(p.map(function(j){return j.x||0})),v)),Re(v)?A.createElement("rect",{x:0,y:f<g?f:f-N,width:v+(u?parseInt("".concat(u),10):1),height:Math.floor(N)}):null}},{key:"renderClipRect",value:function(s){var i=this.props.layout;return i==="vertical"?this.renderVerticalRect(s):this.renderHorizontalRect(s)}},{key:"renderAreaStatically",value:function(s,i,p,c){var u=this.props,f=u.layout,g=u.type,N=u.stroke,v=u.connectNulls,j=u.isRange;u.ref;var R=Qt(u,Ur);return A.createElement(Ae,{clipPath:p?"url(#clipPath-".concat(c,")"):null},A.createElement(ut,Pe({},te(R,!0),{points:s,connectNulls:v,type:g,baseLine:i,layout:f,stroke:"none",className:"recharts-area-area"})),N!=="none"&&A.createElement(ut,Pe({},te(this.props,!1),{className:"recharts-area-curve",layout:f,type:g,connectNulls:v,fill:"none",points:s})),N!=="none"&&j&&A.createElement(ut,Pe({},te(this.props,!1),{className:"recharts-area-curve",layout:f,type:g,connectNulls:v,fill:"none",points:i})))}},{key:"renderAreaWithAnimation",value:function(s,i){var p=this,c=this.props,u=c.points,f=c.baseLine,g=c.isAnimationActive,N=c.animationBegin,v=c.animationDuration,j=c.animationEasing,R=c.animationId,O=this.state,D=O.prevPoints,T=O.prevBaseLine;return A.createElement(Gt,{begin:N,duration:v,isActive:g,easing:j,from:{t:0},to:{t:1},key:"area-".concat(R),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(G){var M=G.t;if(D){var Z=D.length/u.length,_=u.map(function(K,be){var V=Math.floor(be*Z);if(D[V]){var Q=D[V],X=ce(Q.x,K.x),ye=ce(Q.y,K.y);return we(we({},K),{},{x:X(M),y:ye(M)})}return K}),$;if(Re(f)&&typeof f=="number"){var z=ce(T,f);$=z(M)}else if(at(f)||Ja(f)){var ae=ce(T,0);$=ae(M)}else $=f.map(function(K,be){var V=Math.floor(be*Z);if(T[V]){var Q=T[V],X=ce(Q.x,K.x),ye=ce(Q.y,K.y);return we(we({},K),{},{x:X(M),y:ye(M)})}return K});return p.renderAreaStatically(_,$,s,i)}return A.createElement(Ae,null,A.createElement("defs",null,A.createElement("clipPath",{id:"animationClipPath-".concat(i)},p.renderClipRect(M))),A.createElement(Ae,{clipPath:"url(#animationClipPath-".concat(i,")")},p.renderAreaStatically(u,f,s,i)))})}},{key:"renderArea",value:function(s,i){var p=this.props,c=p.points,u=p.baseLine,f=p.isAnimationActive,g=this.state,N=g.prevPoints,v=g.prevBaseLine,j=g.totalLength;return f&&c&&c.length&&(!N&&j>0||!ft(N,c)||!ft(v,u))?this.renderAreaWithAnimation(s,i):this.renderAreaStatically(c,u,s,i)}},{key:"render",value:function(){var s,i=this.props,p=i.hide,c=i.dot,u=i.points,f=i.className,g=i.top,N=i.left,v=i.xAxis,j=i.yAxis,R=i.width,O=i.height,D=i.isAnimationActive,T=i.id;if(p||!u||!u.length)return null;var G=this.state.isAnimationFinished,M=u.length===1,Z=Oe("recharts-area",f),_=v&&v.allowDataOverflow,$=j&&j.allowDataOverflow,z=_||$,ae=at(T)?this.id:T,K=(s=te(c,!1))!==null&&s!==void 0?s:{r:3,strokeWidth:2},be=K.r,V=be===void 0?3:be,Q=K.strokeWidth,X=Q===void 0?2:Q,ye=Za(c)?c:{},Ge=ye.clipDot,Ue=Ge===void 0?!0:Ge,Se=V*2+X;return A.createElement(Ae,{className:Z},_||$?A.createElement("defs",null,A.createElement("clipPath",{id:"clipPath-".concat(ae)},A.createElement("rect",{x:_?N:N-R/2,y:$?g:g-O/2,width:_?R:R*2,height:$?O:O*2})),!Ue&&A.createElement("clipPath",{id:"clipPath-dots-".concat(ae)},A.createElement("rect",{x:N-Se/2,y:g-Se/2,width:R+Se,height:O+Se}))):null,M?null:this.renderArea(z,ae),(c||M)&&this.renderDots(z,Ue,ae),(!D||G)&&Ut.renderCallByParent(this.props,u))}}],[{key:"getDerivedStateFromProps",value:function(s,i){return s.animationId!==i.prevAnimationId?{prevAnimationId:s.animationId,curPoints:s.points,curBaseLine:s.baseLine,prevPoints:i.curPoints,prevBaseLine:i.curBaseLine}:s.points!==i.curPoints||s.baseLine!==i.curBaseLine?{curPoints:s.points,curBaseLine:s.baseLine}:null}}])}(S.PureComponent);Zt=Ce;de(Ce,"displayName","Area");de(Ce,"defaultProps",{stroke:"#3182bd",fill:"#3182bd",fillOpacity:.6,xAxisId:0,yAxisId:0,legendType:"line",connectNulls:!1,points:[],dot:!1,activeDot:!0,hide:!1,isAnimationActive:!Kt.isSsr,animationBegin:0,animationDuration:1500,animationEasing:"ease"});de(Ce,"getBaseValue",function(r,a,o,s){var i=r.layout,p=r.baseValue,c=a.props.baseValue,u=c??p;if(Re(u)&&typeof u=="number")return u;var f=i==="horizontal"?s:o,g=f.scale.domain();if(f.type==="number"){var N=Math.max(g[0],g[1]),v=Math.min(g[0],g[1]);return u==="dataMin"?v:u==="dataMax"||N<0?N:Math.max(Math.min(g[0],g[1]),0)}return u==="dataMin"?g[0]:u==="dataMax"?g[1]:g[0]});de(Ce,"getComposedData",function(r){var a=r.props,o=r.item,s=r.xAxis,i=r.yAxis,p=r.xAxisTicks,c=r.yAxisTicks,u=r.bandSize,f=r.dataKey,g=r.stackedData,N=r.dataStartIndex,v=r.displayedData,j=r.offset,R=a.layout,O=g&&g.length,D=Zt.getBaseValue(a,o,s,i),T=R==="horizontal",G=!1,M=v.map(function(_,$){var z;O?z=g[N+$]:(z=tt(_,f),Array.isArray(z)?G=!0:z=[D,z]);var ae=z[1]==null||O&&tt(_,f)==null;return T?{x:Dt({axis:s,ticks:p,bandSize:u,entry:_,index:$}),y:ae?null:i.scale(z[1]),value:z,payload:_}:{x:ae?null:s.scale(z[1]),y:Dt({axis:i,ticks:c,bandSize:u,entry:_,index:$}),value:z,payload:_}}),Z;return O||G?Z=M.map(function(_){var $=Array.isArray(_.value)?_.value[0]:null;return T?{x:_.x,y:$!=null&&_.y!=null?i.scale($):null}:{x:$!=null?s.scale($):null,y:_.y}}):Z=T?i.scale(D):s.scale(D),we({points:M,baseLine:Z,layout:R,isRange:G},j)});de(Ce,"renderDotItem",function(r,a){var o;if(A.isValidElement(r))o=A.cloneElement(r,a);else if(ke(r))o=r(a);else{var s=Oe("recharts-area-dot",typeof r!="boolean"?r.className:""),i=a.key,p=Qt(a,Kr);o=A.createElement(Ht,Pe({},p,{key:i,className:s}))}return o});var es=Wt({chartName:"RadarChart",GraphicalChild:He,axisComponents:[{axisType:"angleAxis",AxisComp:Vt},{axisType:"radiusAxis",AxisComp:Xt}],formatAxisMap:er,defaultProps:{layout:"centric",startAngle:90,endAngle:-270,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"}}),ts=Wt({chartName:"AreaChart",GraphicalChild:Ce,axisComponents:[{axisType:"xAxis",AxisComp:Qe},{axisType:"yAxis",AxisComp:et}],formatAxisMap:tr});const as=[8,9,10,11,12,14,16,18,20,24,28,32,36,48],Te=[{name:"A",value:400},{name:"B",value:300},{name:"C",value:200}],rs=[{id:"Vazirmatn",label:"وزیرمتن (پیش‌فرض)"},{id:"IRANSans",label:"ایران سنس"},{id:"Sahel",label:"ساحل"},{id:"Samim",label:"صمیم"},{id:"Tahoma",label:"تاهوما"},{id:"Arial",label:"Arial"},{id:"Times New Roman",label:"Times New Roman"}],ss=["#800020","#2c3e50","#38bdf8","#10b981","#f97316","#333333"],ie={work_orders:["id","tracking_code","requester_name","request_date","equipment_name","failure_description","status","downtime"],shift_reports:["id","shift_date","shift_name","supervisor_name","total_production_a","total_production_b"],lab_reports:["id","report_date","sample_code","fe_percent","feo_percent","s_percent"],warehouse_reports:["id","tracking_code","report_date","type","qty","receiver_name"],scale_reports:["id","tracking_code","report_date","material","truck_no","net_weight","origin","destination"],hse_reports:["id","tracking_code","date","type","description"],parts:["id","code","name","current_stock","min_stock","unit_price"],personnel:["id","full_name","unit","personnel_code"]},Ze=Ua.find(r=>r.id==="reports-group"),ns=Ze!=null&&Ze.submenu?Ze.submenu.map(r=>({id:r.id,label:r.title,path:r.path||"#"})):[],os=[{id:"permits",label:"مجوز کار (PTW)",path:"/permits"},{id:"projects",label:"کنترل پروژه",path:"/projects"},{id:"documents",label:"اسناد فنی",path:"/documents"},{id:"suggestions",label:"پیشنهادات فنی",path:"/suggestions"},{id:"meetings",label:"صورتجلسات",path:"/meetings"},{id:"inventory",label:"موجودی انبار",path:"/inventory"},{id:"partrequest",label:"درخواست کالا",path:"/part-requests"},{id:"purchases",label:"درخواست خرید",path:"/purchases"},{id:"training-courses",label:"دوره‌های آموزشی",path:"/training-courses"},{id:"training",label:"ماتریس مهارت و آموزش",path:"/training"},{id:"performance",label:"امتیاز عملکرد",path:"/performance"}],ls=["reportHeader","pageHeader","groupHeader","detail","groupFooter","reportFooter","pageFooter"],is=["factory_manager","production_manager","maintenance_manager","supervisor","admin"],xs=()=>{const[r,a]=S.useState("LIST"),[o,s]=S.useState([]),[i,p]=S.useState([]),[c,u]=S.useState({id:"new",title:"قالب گزارش تولید روزانه",targetModule:"productionreport",elements:[{id:"el-1",type:"HEADER",layout:{x:20,y:20,width:720,height:100},band:"reportHeader",props:{titleProps:{text:"شرکت توسعه معدنی و صنعتی صبانور",fontSize:24,bold:!0,color:"#800020",align:"center"},subtitleProps:{text:"گزارش شیفت تولید کارخانه کنسانتره همدان",fontSize:16,color:"#333",align:"center"},logoType:"DEFAULT",detailsProps:{items:[{id:"d1",label:"کد رهگیری",value:"..."},{id:"d2",label:"تاریخ",value:"..."},{id:"d3",label:"شیفت",value:"..."}],labelStyle:{fontSize:10,color:"#555"},valueStyle:{fontSize:10,color:"#111",bold:!0},dividerStyle:"dashed"},borderStyle:"BOTTOM",borderColor:"#800020",borderWidth:4}}],datasets:[],parameters:[],pageSettings:{size:"A4",orientation:"portrait",marginTop:12,marginRight:12,marginBottom:12,marginLeft:12,keepTogether:!0},governance:{requiredRoles:[],requiresApproval:!1,approvedAt:null,approvedBy:null}}),[f,g]=S.useState("el-1"),[N,v]=S.useState(null),[j,R]=S.useState(null),[O,D]=S.useState([]),[T,G]=S.useState([]),[M,Z]=S.useState(!0),[_,$]=S.useState(!0),[z,ae]=S.useState(!1),[K,be]=S.useState(!0),[V,Q]=S.useState({base:!0,data:!0,charts:!0}),[X,ye]=S.useState({datasets:!0,params:!0,page:!0,governance:!0}),[Ge,Ue]=S.useState([]),[Se,vt]=S.useState({layout:!0,appearance:!0,dataSource:!0,header:!0,text:!0,image:!0,stat:!0,table:!0,chart:!0,actions:!0}),ot=S.useRef(null),jt=S.useRef(null),Nt=S.useRef(null),Le=S.useRef(null),De=S.useRef(!1),k=c.elements.find(t=>t.id===f),Ke=c.pageSettings||{size:"A4",orientation:"portrait"},We=Ke.size==="A3"?{w:297,h:420}:Ke.size==="Letter"?{w:216,h:279}:{w:210,h:297};Ke.orientation==="landscape"?We.h:We.w,Ke.orientation==="landscape"?We.w:We.h,S.useEffect(()=>{if(!Le.current){Le.current=c;return}if(De.current){De.current=!1,Le.current=c;return}D(t=>[...t.slice(-39),Le.current]),G([]),Le.current=c},[c]);const pe=()=>s(Wa()),Ve=S.useMemo(()=>{const t=new Map;return ns.forEach(l=>t.set(l.id,l.label)),os.forEach(l=>t.set(l.id,l.label)),i.forEach(l=>t.set(l.id,l.label)),Array.from(t.entries()).map(([l,d])=>({id:l,label:d}))},[i]),lt=t=>{var l;return((l=Ve.find(d=>d.id===t))==null?void 0:l.label)||t},wt=t=>{ye({datasets:t,params:t,page:t,governance:t}),vt(l=>{const d={};return Object.keys(l).forEach(x=>{d[x]=t}),d})},aa=t=>{if(!t)return"-";const l=new Date(t);return Number.isNaN(l.getTime())?t:l.toLocaleString("fa-IR")},ra=t=>({id:"new",title:`قالب ${lt(t)}`,targetModule:t,elements:[{id:"el-1",type:"HEADER",layout:{x:20,y:20,width:720,height:100},band:"reportHeader",props:{titleProps:{text:"شرکت توسعه معدنی و صنعتی صبانور",fontSize:24,bold:!0,color:"#800020",align:"center"},subtitleProps:{text:`${lt(t)}`,fontSize:16,color:"#333",align:"center"},logoType:"DEFAULT",detailsProps:{items:[{id:"d1",label:"کد رهگیری",value:"tracking_code"},{id:"d2",label:"تاریخ",value:"shift_date"},{id:"d3",label:"شیفت",value:"shift_name"}],labelStyle:{fontSize:10,color:"#555"},valueStyle:{fontSize:10,color:"#111",bold:!0},dividerStyle:"dashed"},borderStyle:"BOTTOM",borderColor:"#800020",borderWidth:4}}],datasets:[],parameters:[],pageSettings:{size:"A4",orientation:"portrait",marginTop:12,marginRight:12,marginBottom:12,marginLeft:12,keepTogether:!0},governance:{requiredRoles:[],requiresApproval:!1,approvedAt:null,approvedBy:null}}),Xe=t=>{var x,b,h,m;const l=Xa(t);if(l){u(l),g(((b=(x=l.elements)==null?void 0:x[0])==null?void 0:b.id)||null);return}const d=ra(t);u(d),g(((m=(h=d.elements)==null?void 0:h[0])==null?void 0:m.id)||null)};S.useEffect(()=>{(async()=>{const{data:l}=await Et.from("app_settings").select("org_logo").single();l!=null&&l.org_logo&&v(l.org_logo)})()},[]),S.useEffect(()=>{const t=async()=>{const d=await Ga();p(d.map(x=>({id:x.slug,label:x.title})))},l=()=>t();return t(),window.addEventListener("report-definitions-changed",l),()=>window.removeEventListener("report-definitions-changed",l)},[]),S.useEffect(()=>{Ka(),pe()},[]),S.useEffect(()=>{const t=l=>{if(l.key==="Delete"&&f){const d=document.activeElement;if(d&&(d.tagName==="INPUT"||d.tagName==="TEXTAREA"))return;Ct(f)}};return window.addEventListener("keydown",t),()=>{window.removeEventListener("keydown",t)}},[f,c.elements]),S.useEffect(()=>{const t=d=>{if(!j||!Nt.current)return;const x=d.clientX-j.startX,b=d.clientY-j.startY,{startLayout:h}=j;let m={...h};j.type==="move"?(m.x=Math.max(0,h.x+x),m.y=Math.max(0,h.y+b)):(j.type.includes("r")&&(m.width=Math.max(50,h.width+x)),j.type.includes("l")&&(m.width=Math.max(50,h.width-x),m.x=h.x+x),j.type.includes("b")&&(m.height=Math.max(30,h.height+b)),j.type.includes("t")&&(m.height=Math.max(30,h.height-b),m.y=h.y+b)),_&&(m.x=Math.round(m.x/8)*8,m.y=Math.round(m.y/8)*8,m.width=Math.round(m.width/4)*4,m.height=Math.round(m.height/4)*4),y(j.elementId,m,"layout")},l=()=>R(null);return j&&(window.addEventListener("mousemove",t),window.addEventListener("mouseup",l,{once:!0})),()=>{window.removeEventListener("mousemove",t),window.removeEventListener("mouseup",l)}},[j,_]);const At=(t,l,d)=>{t.preventDefault(),t.stopPropagation(),!d.props.locked&&(g(d.id),R({type:l,elementId:d.id,startX:t.clientX,startY:t.clientY,startLayout:d.layout}))},oe=t=>{const l=Math.random().toString(36).substr(2,9);let d={borderColor:"#cccccc",borderWidth:0},x={x:50,y:150,width:400,height:150};switch(t){case"TEXT":d={...d,textProps:{text:"متن نمونه...",fontSize:14,align:"right"}},x.height=50;break;case"STAT_CARD":d={...d,labelProps:{text:"تولید کل",fontSize:11,color:"#555",highlight:!1},valueProps:{text:"2,500",fontSize:24,bold:!0},unitProps:{text:"تن",fontSize:11},themeColor:"#2563eb",goalProps:{show:!0,value:3e3,label:"هدف",color:"#10b981"},divider:"NONE",aggregation:"COUNT"},x.width=180,x.height=100;break;case"CHART_BAR":case"CHART_PIE":case"CHART_LINE":case"CHART_AREA":case"CHART_RADAR":d={...d,titleProps:{text:"نمودار",align:"center",fontSize:12,bold:!0},chartColor:"#800020",chartPalette:"#800020,#2563eb,#10b981,#f97316,#7c3aed",showLegend:!0,showGrid:!0,showTooltip:!0,barRadius:4,innerRadius:30,lineType:"monotone",showDots:!0,stacked:!1,areaOpacity:.35,topN:20,sortChartBy:"value_desc",pieLabelMode:"none"},x.height=250;break;case"TABLE":const b=ie.work_orders.slice(0,4).map(h=>({id:Ie(),key:h,header:h,align:"right"}));d={...d,dataSource:"work_orders",columns:b,rows:4,headerStyle:{bold:!0,color:"#333",backgroundColor:"#f3f4f6"},rowStyle:{color:"#555"},alternateRowColor:"#fafafa",showRowNumber:!0},x.height=250;break;case"IMAGE":d={...d,customLogo:"",imageFit:"contain",backgroundColor:"#ffffff"},x={x:60,y:180,width:220,height:160};break}u(b=>({...b,elements:[...b.elements,{id:l,type:t,layout:x,props:d}]})),g(l)},Ct=t=>{u(l=>({...l,elements:l.elements.filter(d=>d.id!==t)})),g(null)},y=(t,l,d="props")=>{u(x=>({...x,elements:x.elements.map(b=>b.id!==t?b:d==="props"?{...b,props:{...b.props,...l}}:{...b,layout:{...b.layout,...l}})}))},I=(t,l)=>{k&&u(d=>{const x=d.elements.map(b=>{if(b.id!==k.id)return b;const h=JSON.parse(JSON.stringify(b.props)),m=t.split(".");let F=h;for(let U=0;U<m.length-1;U++)F[m[U]]===void 0&&(F[m[U]]={}),F=F[m[U]];return F[m[m.length-1]]=l,{...b,props:h}});return{...d,elements:x}})},sa=async()=>{var h,m;const t=localStorage.getItem("currentUser");let l=null;try{l=t?JSON.parse(t):null}catch{l=null}const d=(l==null?void 0:l.fullName)||(l==null?void 0:l.username)||"سیستم",x=(l==null?void 0:l.username)||void 0,b=qa({id:"",title:c.title,targetModule:c.targetModule,elements:c.elements},{activate:!0,createdBy:d,createdByUsername:x});try{await Et.from("report_definitions").update({template_schema:{moduleId:c.targetModule,linkedTemplateId:b.id,linkedTemplateVersion:b.version}}).eq("slug",c.targetModule)}catch{}u(b),g(((m=(h=b.elements)==null?void 0:h[0])==null?void 0:m.id)||null),pe(),alert(`قالب ذخیره شد. نسخه ${b.version} فعال شد.`)},na=()=>{var l,d;if(O.length===0)return;const t=O[O.length-1];De.current=!0,D(x=>x.slice(0,-1)),G(x=>[c,...x].slice(0,40)),u(t),g(((d=(l=t.elements)==null?void 0:l[0])==null?void 0:d.id)||null)},oa=()=>{var l,d;if(T.length===0)return;const t=T[0];De.current=!0,G(x=>x.slice(1)),D(x=>[...x.slice(-39),c]),u(t),g(((d=(l=t.elements)==null?void 0:l[0])==null?void 0:d.id)||null)},la=()=>{if(!k)return;const t={...JSON.parse(JSON.stringify(k)),id:Ie(),layout:{...k.layout,x:k.layout.x+12,y:k.layout.y+12}};u(l=>({...l,elements:[...l.elements,t]})),g(t.id)},ia=()=>{k&&y(k.id,{locked:!k.props.locked})},it=t=>{if(!k)return;const l=794,d=1123,x=k.layout;let b=x.x,h=x.y;t==="left"&&(b=0),t==="center-x"&&(b=Math.max(0,Math.round((l-x.width)/2))),t==="right"&&(b=Math.max(0,l-x.width)),t==="top"&&(h=0),t==="center-y"&&(h=Math.max(0,Math.round((d-x.height)/2))),t==="bottom"&&(h=Math.max(0,d-x.height)),y(k.id,{x:b,y:h},"layout")},ca=()=>{const t=JSON.stringify(c,null,2),l=new Blob([t],{type:"application/json;charset=utf-8"}),d=URL.createObjectURL(l),x=document.createElement("a");x.href=d,x.download=`template-${c.targetModule}-${Date.now()}.json`,document.body.appendChild(x),x.click(),document.body.removeChild(x),URL.revokeObjectURL(d)},da=t=>{var x;const l=(x=t.target.files)==null?void 0:x[0];if(!l)return;const d=new FileReader;d.onload=()=>{var b,h;try{const m=JSON.parse(String(d.result||"{}"));if(!m||!Array.isArray(m.elements)){alert("ساختار فایل قالب معتبر نیست.");return}const F={...m,id:`import-${Date.now()}`,targetModule:c.targetModule||m.targetModule||"productionreport"};De.current=!0,u(F),g(((h=(b=F.elements)==null?void 0:b[0])==null?void 0:h.id)||null),alert("قالب با موفقیت ایمپورت شد. در صورت نیاز، ذخیره نسخه جدید را بزنید.")}catch{alert("خطا در خواندن فایل JSON قالب.")}finally{t.target.value=""}},d.readAsText(l,"utf-8")},pa=(t,l)=>{Va(t),pe(),c.targetModule===l&&Xe(l)},ua=t=>{window.confirm("این نسخه حذف شود؟")&&(Lt(t),pe(),c.id===t&&Xe(c.targetModule))},ha=S.useMemo(()=>[{header:"ماژول",accessor:t=>lt(t.targetModule||""),sortKey:"targetModule"},{header:"عنوان",accessor:t=>t.title,sortKey:"title"},{header:"نسخه",accessor:t=>t.version,sortKey:"version"},{header:"وضعیت",accessor:t=>t.isActive?e.jsx("span",{className:"text-green-700 bg-green-50 px-2 py-1 rounded",children:"فعال"}):e.jsx("span",{className:"text-gray-500",children:"غیرفعال"}),sortKey:"isActive"},{header:"تاریخ",accessor:t=>aa(t.updatedAt||t.createdAt),sortKey:"updatedAt"}],[Ve]),xa=()=>{var t;Xe(((t=Ve[0])==null?void 0:t.id)||"productionreport"),a("DESIGN")},ma=t=>{var l,d;u(t),g(((d=(l=t.elements)==null?void 0:l[0])==null?void 0:d.id)||null),a("DESIGN")},ga=()=>{pe(),a("LIST")},kt=(t,l)=>{if(!k||!k.props.detailsProps)return;const d=[...k.props.detailsProps.items],x=d[t],b=l==="UP"?t-1:t+1;b<0||b>=d.length||(d[t]=d[b],d[b]=x,I("detailsProps",{...k.props.detailsProps,items:d}))},fa=t=>{var d;const l=(d=t.target.files)==null?void 0:d[0];if(l&&k){if(l.size>512*1024){alert("حجم فایل نباید بیشتر از 512 کیلوبایت باشد.");return}const x=new FileReader;x.onloadend=()=>y(k.id,{customLogo:x.result,logoType:"CUSTOM"}),x.readAsDataURL(l)}},ba=()=>{const t=`ds_${Ie()}`,l="work_orders";u(d=>({...d,datasets:[...d.datasets||[],{id:t,source:l,alias:t,joins:[],filters:[],sort:[],groupBy:[],aggregates:[],calculatedFields:[]}]}))},ue=(t,l)=>{u(d=>({...d,datasets:(d.datasets||[]).map(x=>x.id===t?{...x,...l}:x)}))},ya=t=>{u(l=>({...l,datasets:(l.datasets||[]).filter(d=>d.id!==t)}))},va=()=>{u(t=>({...t,parameters:[...t.parameters||[],{id:Ie(),key:`param_${(t.parameters||[]).length+1}`,label:"پارامتر جدید",type:"text",defaultValue:""}]}))},ct=(t,l)=>{u(d=>({...d,parameters:(d.parameters||[]).map(x=>x.id===t?{...x,...l}:x)}))},ja=t=>{u(l=>({...l,parameters:(l.parameters||[]).filter(d=>d.id!==t)}))},ee=t=>{const l={fontFamily:(t==null?void 0:t.fontFamily)||"Vazirmatn",fontSize:t==null?void 0:t.fontSize,fontWeight:t!=null&&t.bold?"bold":"normal",fontStyle:t!=null&&t.italic?"italic":"normal",textDecoration:t!=null&&t.underline?"underline":"none",color:t==null?void 0:t.color,textAlign:t==null?void 0:t.align,backgroundColor:t==null?void 0:t.backgroundColor};return t!=null&&t.backgroundColor&&t.backgroundColor!=="transparent"&&(l.padding="2px 6px",l.borderRadius="4px",l.display="inline-block"),l},Na=t=>{const l={backgroundColor:t.props.backgroundColor,overflow:"hidden"},d=t.props.borderWidth||0,x=t.props.borderColor||"transparent",b=`${d}px solid ${x}`;if(t.type==="HEADER"){const m=t.props.borderStyle||"NONE";if(d>0)switch(m){case"BOX":l.border=b,l.borderRadius="8px";break;case"TOP_BOTTOM":l.borderTop=b,l.borderBottom=b;break;case"BOTTOM":l.borderBottom=b;break}}else l.borderRadius="8px",d>0&&(l.border=b);const h=()=>{var m,F,U,le,re,Y,ve,E,J;switch(t.type){case"HEADER":const H=t.props.detailsProps;return e.jsxs("div",{className:"flex items-center justify-between w-full h-full p-4",children:[e.jsx("div",{className:"w-16 h-16 flex items-center justify-center overflow-hidden",children:t.props.logoType==="CUSTOM"?t.props.customLogo?e.jsx("img",{src:t.props.customLogo,alt:"Custom Logo",className:"w-full h-full object-contain"}):e.jsx("div",{className:"w-full h-full bg-gray-200 flex items-center justify-center text-[9px] font-bold text-gray-400 text-center leading-tight",children:"بارگذاری لوگو"}):N?e.jsx("img",{src:N,alt:"Default Logo",className:"w-full h-full object-contain"}):e.jsx("div",{className:"w-full h-full bg-gray-200 flex items-center justify-center text-xs font-bold text-gray-400",children:"LOGO"})}),e.jsxs("div",{className:"text-center flex-1",children:[e.jsx("h1",{style:ee(t.props.titleProps),children:(m=t.props.titleProps)==null?void 0:m.text}),e.jsx("h2",{style:ee(t.props.subtitleProps),children:(F=t.props.subtitleProps)==null?void 0:F.text})]}),e.jsx("div",{className:"w-32 text-right space-y-1 opacity-70",children:H==null?void 0:H.items.map((se,Ne)=>e.jsxs("div",{className:`flex justify-between items-center ${H.dividerStyle!=="none"&&Ne<H.items.length-1?"border-b":""}`,style:{borderStyle:H.dividerStyle},children:[e.jsxs("span",{style:ee(H.labelStyle),children:[se.label,":"]}),e.jsx("span",{style:ee(H.valueStyle),children:se.value})]},se.id))})]});case"TEXT":return e.jsx("div",{className:"p-2 w-full h-full",style:ee(t.props.textProps),children:(U=t.props.textProps)==null?void 0:U.text});case"STAT_CARD":const q=t.props.goalProps,qe=parseFloat(String(((le=t.props.valueProps)==null?void 0:le.text)||"0").replace(/,/g,"")),Me=(q==null?void 0:q.value)||0,n=Me>0?Math.min(qe/Me*100,100):0,C=ee(t.props.labelProps);(re=t.props.labelProps)!=null&&re.highlight&&(C.backgroundColor=`${t.props.themeColor}33`,C.borderRadius="6px",C.padding="2px 6px",C.display="inline-block");const L=t.props.dataSource&&t.props.valueField?`[${t.props.aggregation||"COUNT"}(${t.props.valueField})]`:(Y=t.props.valueProps)==null?void 0:Y.text;return e.jsxs("div",{className:"p-3 text-center h-full flex flex-col justify-between",style:{backgroundColor:`${t.props.themeColor}1A`,borderColor:`${t.props.themeColor}30`,borderWidth:1,borderRadius:"inherit"},children:[e.jsxs("div",{children:[e.jsx("span",{className:"block mb-1",style:C,children:(ve=t.props.labelProps)==null?void 0:ve.text}),t.props.divider==="MIDDLE"&&e.jsx("div",{className:"my-2 border-t",style:{borderColor:`${t.props.themeColor}4D`}}),e.jsxs("span",{className:"block",style:ee(t.props.valueProps),children:[L," ",e.jsx("small",{style:ee(t.props.unitProps),children:(E=t.props.unitProps)==null?void 0:E.text})]})]}),(q==null?void 0:q.show)&&e.jsxs("div",{className:"mt-2 text-xs",children:[e.jsxs("div",{className:"flex justify-between text-gray-500 mb-1",children:[e.jsx("span",{children:q.label}),e.jsxs("span",{children:[Math.round(n),"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-600 rounded-full h-1.5",children:e.jsx("div",{className:"h-1.5 rounded-full",style:{width:`${n}%`,backgroundColor:q.color||"#10b981"}})})]})]});case"TABLE":const{columns:w,headerStyle:B,rowStyle:je,alternateRowColor:P,showRowNumber:Ye,rows:Ca}=t.props,ka=(B==null?void 0:B.backgroundColor)||"#f3f4f6",dt=ee(B);return delete dt.backgroundColor,e.jsx("div",{className:"w-full h-full p-2 overflow-auto",children:e.jsxs("table",{className:"w-full border-collapse text-xs",children:[e.jsx("thead",{children:e.jsxs("tr",{style:{backgroundColor:ka},children:[Ye&&e.jsx("th",{style:dt,className:"p-2 border",children:"#"}),w==null?void 0:w.map(se=>e.jsx("th",{style:{...dt,textAlign:se.align},className:"p-2 border",children:se.header},se.id))]})}),e.jsx("tbody",{children:Array.from({length:Ca||3}).map((se,Ne)=>e.jsxs("tr",{style:{backgroundColor:Ne%2!==0?P:je==null?void 0:je.backgroundColor},children:[Ye&&e.jsx("td",{style:ee(je),className:"p-2 border text-center",children:Ne+1}),w==null?void 0:w.map(St=>e.jsx("td",{style:{...ee(je),textAlign:St.align},className:"p-2 border text-gray-400",children:"داده نمونه"},St.id))]},Ne))})]})});case"IMAGE":return e.jsx("div",{className:"w-full h-full p-1 flex items-center justify-center bg-gray-50",children:t.props.customLogo?e.jsx("img",{src:t.props.customLogo,alt:"Template",className:"w-full h-full",style:{objectFit:t.props.imageFit||"contain"}}):e.jsxs("div",{className:"text-xs text-gray-400 text-center",children:[e.jsx(Rt,{className:"w-5 h-5 mx-auto mb-1"}),"تصویر انتخاب نشده"]})});case"CHART_BAR":case"CHART_PIE":case"CHART_LINE":case"CHART_AREA":case"CHART_RADAR":const Pt=(t.props.chartPalette||"").split(",").map(se=>se.trim()).filter(Boolean),he=Pt.length?Pt:[t.props.chartColor||"#800020","#2563eb","#10b981","#f97316"];return e.jsxs("div",{className:"w-full h-full p-2 flex flex-col",children:[e.jsx("h4",{className:"text-center mb-1 shrink-0",style:ee(t.props.titleProps),children:(J=t.props.titleProps)==null?void 0:J.text}),e.jsx("div",{className:"flex-1",children:e.jsx(ar,{width:"100%",height:"100%",children:t.type==="CHART_BAR"?e.jsxs(rr,{data:Te,margin:{top:5,right:5,left:-20,bottom:t.props.showLegend?20:0},children:[t.props.showGrid!==!1&&e.jsx(ht,{strokeDasharray:"3 3",vertical:!1}),e.jsx(Qe,{dataKey:"name",fontSize:10}),e.jsx(et,{fontSize:10}),t.props.showTooltip!==!1&&e.jsx(Be,{}),e.jsx(sr,{dataKey:"value",fill:he[0],radius:[t.props.barRadius||0,t.props.barRadius||0,0,0]})]}):t.type==="CHART_PIE"?e.jsxs(ir,{margin:{bottom:t.props.showLegend?20:0},children:[e.jsx(cr,{data:Te,cx:"50%",cy:"50%",innerRadius:t.props.innerRadius||0,outerRadius:60,fill:he[0],paddingAngle:5,dataKey:"value",children:Te.map((se,Ne)=>e.jsx(nr,{fill:he[Ne%he.length]},Ne))}),t.props.showTooltip!==!1&&e.jsx(Be,{})]}):t.type==="CHART_LINE"?e.jsxs(dr,{data:Te,margin:{top:5,right:5,left:-20,bottom:t.props.showLegend?20:0},children:[t.props.showGrid!==!1&&e.jsx(ht,{strokeDasharray:"3 3"}),e.jsx(Qe,{dataKey:"name",fontSize:10}),e.jsx(et,{fontSize:10}),t.props.showTooltip!==!1&&e.jsx(Be,{}),e.jsx(pr,{type:t.props.lineType||"monotone",dataKey:"value",stroke:he[0],strokeWidth:2,dot:t.props.showDots})]}):t.type==="CHART_AREA"?e.jsxs(ts,{data:Te,margin:{top:5,right:5,left:-20,bottom:t.props.showLegend?20:0},children:[t.props.showGrid!==!1&&e.jsx(ht,{strokeDasharray:"3 3"}),e.jsx(Qe,{dataKey:"name",fontSize:10}),e.jsx(et,{fontSize:10}),t.props.showTooltip!==!1&&e.jsx(Be,{}),e.jsx(Ce,{type:t.props.lineType||"monotone",dataKey:"value",stroke:he[0],fill:he[0],fillOpacity:t.props.areaOpacity??.35})]}):e.jsxs(es,{data:Te,children:[e.jsx(qt,{}),e.jsx(Vt,{dataKey:"name"}),e.jsx(Xt,{}),t.props.showTooltip!==!1&&e.jsx(Be,{}),e.jsx(He,{dataKey:"value",stroke:he[0],fill:he[0],fillOpacity:t.props.areaOpacity??.35})]})})}),t.props.showLegend&&e.jsx(or,{wrapperStyle:{fontSize:"10px",direction:"ltr"}})]});default:return null}};return e.jsx("div",{style:l,className:"w-full h-full",children:h()})},wa=()=>{var l,d,x,b;const t=h=>{ye(m=>({...m,[h]:!m[h]}))};return e.jsxs("div",{className:"space-y-4 border-b pb-4 mb-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("button",{type:"button",onClick:()=>t("datasets"),className:"w-full flex items-center justify-between px-2 py-1 rounded text-xs font-bold text-gray-500 uppercase bg-gray-50 hover:bg-gray-100",children:[e.jsx("span",{children:"مدل داده و دیتاست"}),X.datasets?e.jsx(xe,{className:"w-3 h-3"}):e.jsx(me,{className:"w-3 h-3"})]}),!X.datasets&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:ba,className:"w-full text-xs py-1.5 rounded bg-blue-50 text-blue-700",children:"+ Dataset جدید"}),e.jsxs("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:[(c.datasets||[]).map(h=>{var m,F,U,le,re,Y,ve;return e.jsxs("div",{className:"border rounded p-2 space-y-2 bg-gray-50",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"flex-1 p-1 border rounded text-xs ltr text-left",value:h.id,onChange:E=>ue(h.id,{id:E.target.value})}),e.jsx("button",{onClick:()=>ya(h.id),className:"text-xs text-red-600",children:"حذف"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("select",{className:"p-1 border rounded text-xs",value:h.source,onChange:E=>ue(h.id,{source:E.target.value}),children:Object.keys(ie).map(E=>e.jsx("option",{value:E,children:E},E))}),e.jsx("input",{className:"p-1 border rounded text-xs ltr text-left",placeholder:"نام مستعار (alias)",value:h.alias||"",onChange:E=>ue(h.id,{alias:E.target.value})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("input",{className:"p-1 border rounded text-xs ltr text-left",placeholder:"شناسه دیتاست مرجع",value:h.masterDatasetId||"",onChange:E=>ue(h.id,{masterDatasetId:E.target.value||void 0})}),e.jsx("input",{className:"p-1 border rounded text-xs ltr text-left",placeholder:"فیلد ارتباط",value:h.relationField||"",onChange:E=>ue(h.id,{relationField:E.target.value||void 0})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("input",{className:"p-1 border rounded text-xs ltr text-left",placeholder:"فیلد گروه‌بندی",value:((F=(m=h.groupBy)==null?void 0:m[0])==null?void 0:F.field)||"",onChange:E=>ue(h.id,{groupBy:E.target.value?[{field:E.target.value}]:[]})}),e.jsx("input",{className:"p-1 border rounded text-xs ltr text-left",placeholder:"فیلد مرتب‌سازی",value:((le=(U=h.sort)==null?void 0:U[0])==null?void 0:le.field)||"",onChange:E=>{var J,H;return ue(h.id,{sort:E.target.value?[{field:E.target.value,direction:((H=(J=h.sort)==null?void 0:J[0])==null?void 0:H.direction)||"desc"}]:[]})}})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("select",{className:"p-1 border rounded text-xs",value:((Y=(re=h.sort)==null?void 0:re[0])==null?void 0:Y.direction)||"desc",onChange:E=>{var J,H;return ue(h.id,{sort:(H=(J=h.sort)==null?void 0:J[0])!=null&&H.field?[{field:h.sort[0].field,direction:E.target.value}]:[]})},children:[e.jsx("option",{value:"desc",children:"مرتب‌سازی نزولی"}),e.jsx("option",{value:"asc",children:"مرتب‌سازی صعودی"})]}),e.jsx("input",{className:"p-1 border rounded text-xs ltr text-left",placeholder:"فیلد محاسباتی: KPI = expr",value:(ve=h.calculatedFields)!=null&&ve[0]?`${h.calculatedFields[0].key}=${h.calculatedFields[0].expression}`:"",onChange:E=>{const J=E.target.value,[H,...q]=J.split("=");ue(h.id,{calculatedFields:H&&q.length?[{key:H.trim(),expression:q.join("=").trim()}]:[]})}})]})]},h.id)}),!(c.datasets||[]).length&&e.jsx("div",{className:"text-[11px] text-gray-400 text-center py-2",children:"دیتاستی تعریف نشده است."})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("button",{type:"button",onClick:()=>t("params"),className:"w-full flex items-center justify-between px-2 py-1 rounded text-xs font-bold text-gray-500 uppercase bg-gray-50 hover:bg-gray-100",children:[e.jsx("span",{children:"پارامترهای زمان اجرا"}),X.params?e.jsx(xe,{className:"w-3 h-3"}):e.jsx(me,{className:"w-3 h-3"})]}),!X.params&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:va,className:"w-full text-xs py-1.5 rounded bg-emerald-50 text-emerald-700",children:"+ پارامتر جدید"}),e.jsx("div",{className:"space-y-1 max-h-44 overflow-y-auto",children:(c.parameters||[]).map(h=>e.jsxs("div",{className:"grid grid-cols-12 gap-1",children:[e.jsx("input",{className:"col-span-3 p-1 border rounded text-xs ltr text-left",value:h.key,onChange:m=>ct(h.id,{key:m.target.value})}),e.jsx("input",{className:"col-span-4 p-1 border rounded text-xs",value:h.label,onChange:m=>ct(h.id,{label:m.target.value})}),e.jsxs("select",{className:"col-span-3 p-1 border rounded text-xs",value:h.type,onChange:m=>ct(h.id,{type:m.target.value}),children:[e.jsx("option",{value:"text",children:"متن"}),e.jsx("option",{value:"number",children:"عدد"}),e.jsx("option",{value:"date",children:"تاریخ"}),e.jsx("option",{value:"boolean",children:"بله/خیر"}),e.jsx("option",{value:"select",children:"لیست انتخاب"})]}),e.jsx("button",{className:"col-span-2 text-xs text-red-600",onClick:()=>ja(h.id),children:"حذف"})]},h.id))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("button",{type:"button",onClick:()=>t("page"),className:"w-full flex items-center justify-between px-2 py-1 rounded text-xs font-bold text-gray-500 uppercase bg-gray-50 hover:bg-gray-100",children:[e.jsx("span",{children:"تنظیمات صفحه"}),X.page?e.jsx(xe,{className:"w-3 h-3"}):e.jsx(me,{className:"w-3 h-3"})]}),!X.page&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("select",{className:"p-1 border rounded text-xs",value:((l=c.pageSettings)==null?void 0:l.size)||"A4",onChange:h=>u(m=>({...m,pageSettings:{...m.pageSettings,size:h.target.value}})),children:[e.jsx("option",{value:"A4",children:"A4"}),e.jsx("option",{value:"A3",children:"A3"}),e.jsx("option",{value:"Letter",children:"Letter"})]}),e.jsxs("select",{className:"p-1 border rounded text-xs",value:((d=c.pageSettings)==null?void 0:d.orientation)||"portrait",onChange:h=>u(m=>({...m,pageSettings:{...m.pageSettings,orientation:h.target.value}})),children:[e.jsx("option",{value:"portrait",children:"عمودی"}),e.jsx("option",{value:"landscape",children:"افقی"})]}),["marginTop","marginRight","marginBottom","marginLeft"].map(h=>{var m;return e.jsx("input",{className:"p-1 border rounded text-xs",type:"number",value:((m=c.pageSettings)==null?void 0:m[h])??12,onChange:F=>u(U=>({...U,pageSettings:{...U.pageSettings,[h]:Number(F.target.value)||0}})),placeholder:h},h)})]}),e.jsxs("label",{className:"flex items-center gap-2 text-xs",children:[e.jsx("input",{type:"checkbox",checked:((x=c.pageSettings)==null?void 0:x.keepTogether)!==!1,onChange:h=>u(m=>({...m,pageSettings:{...m.pageSettings,keepTogether:h.target.checked}}))}),"چاپ پیوسته (Keep Together)"]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("button",{type:"button",onClick:()=>t("governance"),className:"w-full flex items-center justify-between px-2 py-1 rounded text-xs font-bold text-gray-500 uppercase bg-gray-50 hover:bg-gray-100",children:[e.jsx("span",{children:"حاکمیت و دسترسی"}),X.governance?e.jsx(xe,{className:"w-3 h-3"}):e.jsx(me,{className:"w-3 h-3"})]}),!X.governance&&e.jsxs(e.Fragment,{children:[e.jsxs("label",{className:"flex items-center gap-2 text-xs",children:[e.jsx("input",{type:"checkbox",checked:!!((b=c.governance)!=null&&b.requiresApproval),onChange:h=>u(m=>({...m,governance:{...m.governance||{},requiresApproval:h.target.checked}}))}),"نیاز به تایید قبل از اجرا"]}),e.jsx("div",{className:"grid grid-cols-2 gap-1",children:is.map(h=>{var m;return e.jsxs("label",{className:"text-[11px] flex items-center gap-1",children:[e.jsx("input",{type:"checkbox",checked:(((m=c.governance)==null?void 0:m.requiredRoles)||[]).includes(h),onChange:F=>{var re;const U=((re=c.governance)==null?void 0:re.requiredRoles)||[],le=F.target.checked?[...new Set([...U,h])]:U.filter(Y=>Y!==h);u(Y=>({...Y,governance:{...Y.governance||{},requiredRoles:le}}))}}),h]},h)})})]})]})]})},Aa=()=>{var le,re,Y,ve,E,J,H,q,qe,Me;if(!k)return e.jsx("div",{className:"text-gray-400 text-center text-sm mt-10",children:"یک المان را برای ویرایش انتخاب کنید."});const t=k,l=n=>Se[n]??!0,d=n=>vt(C=>({...C,[n]:!(C[n]??!0)})),x=(n,C)=>e.jsxs("button",{type:"button",onClick:()=>d(C),className:"w-full flex items-center justify-between px-2 py-1 rounded text-xs font-bold text-gray-500 uppercase bg-gray-50 hover:bg-gray-100",children:[e.jsx("span",{children:n}),l(C)?e.jsx(xe,{className:"w-3 h-3"}):e.jsx(me,{className:"w-3 h-3"})]}),b=({path:n,label:C,disableText:L=!1})=>{const w=n.split(".").reduce((P,Ye)=>P==null?void 0:P[Ye],t.props)||{},[B,je]=S.useState(w.text||"");return S.useEffect(()=>{je(w.text||"")},[w.text]),e.jsxs("div",{className:"space-y-2 border p-2 rounded-lg bg-gray-50/50 dark:bg-gray-700/20",children:[e.jsx("h5",{className:"text-[10px] font-bold text-gray-400",children:C}),w.text!==void 0&&!L&&e.jsx("input",{type:"text",placeholder:"متن...",className:"w-full p-1 border rounded text-xs",value:B,onChange:P=>je(P.target.value),onBlur:()=>I(n+".text",B)}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("select",{className:"w-full p-1 border rounded text-xs",value:w.fontFamily||"Vazirmatn",onChange:P=>I(n+".fontFamily",P.target.value),children:rs.map(P=>e.jsx("option",{value:P.id,children:P.label},P.id))}),e.jsx("select",{className:"w-full p-1 border rounded text-xs",value:w.fontSize||14,onChange:P=>I(n+".fontSize",parseInt(P.target.value)),children:as.map(P=>e.jsxs("option",{value:P,children:[P,"px"]},P))})]}),e.jsxs("div",{className:"space-y-2 pt-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"w-20 text-xs text-gray-500",children:"رنگ متن"}),e.jsx("input",{type:"color",value:w.color||"#000000",onChange:P=>I(n+".color",P.target.value),className:"w-8 h-8 p-0 border-0 rounded cursor-pointer"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"w-20 text-xs text-gray-500",children:"رنگ پس‌زمینه"}),e.jsx("input",{type:"color",value:w.backgroundColor&&w.backgroundColor!=="transparent"?w.backgroundColor:"#ffffff",onChange:P=>I(n+".backgroundColor",P.target.value),className:"w-8 h-8 p-0 border-0 rounded cursor-pointer"}),e.jsx("button",{type:"button",onClick:()=>I(n+".backgroundColor","transparent"),className:`p-1 rounded border-2 transition-colors ${!w.backgroundColor||w.backgroundColor==="transparent"?"border-primary":"border-transparent"}`,title:"بدون پس‌زمینه",children:e.jsx("div",{className:"w-5 h-5 bg-white border border-gray-300 rounded relative overflow-hidden",children:e.jsx("div",{className:"absolute w-full h-0.5 bg-red-500 transform rotate-45 top-1/2 left-0 -translate-y-1/2"})})})]})]}),e.jsxs("div",{className:"mt-2",children:[e.jsx("label",{className:"text-[10px] text-gray-400",children:"رنگ‌های پیشنهادی (برای متن)"}),e.jsx("div",{className:"grid grid-cols-6 gap-1 flex-1 mt-1",children:ss.map(P=>e.jsx("button",{type:"button",onClick:()=>I(n+".color",P),className:"w-5 h-5 rounded-full border border-gray-300",style:{backgroundColor:P},title:`تنظیم رنگ متن به ${P}`},P))})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsxs("div",{className:"flex-1 flex bg-gray-200 dark:bg-gray-600 rounded p-0.5",children:[e.jsx("button",{type:"button",onClick:()=>I(n+".bold",!w.bold),className:`flex-1 p-1 rounded ${w.bold?"bg-white dark:bg-gray-500 shadow":""}`,children:e.jsx(ur,{className:"w-4 h-4 mx-auto"})}),e.jsx("button",{type:"button",onClick:()=>I(n+".italic",!w.italic),className:`flex-1 p-1 rounded ${w.italic?"bg-white dark:bg-gray-500 shadow":""}`,children:e.jsx(hr,{className:"w-4 h-4 mx-auto"})}),e.jsx("button",{type:"button",onClick:()=>I(n+".underline",!w.underline),className:`flex-1 p-1 rounded ${w.underline?"bg-white dark:bg-gray-500 shadow":""}`,children:e.jsx(br,{className:"w-4 h-4 mx-auto"})})]}),e.jsx("div",{className:"flex bg-gray-200 dark:bg-gray-600 rounded p-0.5",children:["right","center","left"].map(P=>e.jsx("button",{type:"button",onClick:()=>I(n+".align",P),className:`p-1 rounded ${w.align===P?"bg-white dark:bg-gray-500 shadow":""}`,children:P==="right"?e.jsx(gt,{className:"w-4 h-4"}):P==="center"?e.jsx(xt,{className:"w-4 h-4"}):e.jsx(mt,{className:"w-4 h-4"})},P))})]})]})},h=(n,C)=>{var w;let L;C?L=[...t.props.columns||[],{id:Ie(),key:n,header:n,align:"right"}]:L=(w=t.props.columns)==null?void 0:w.filter(B=>B.key!==n),y(t.id,{columns:L})},m=(n,C)=>{if(!t.props.columns)return;const L=t.props.columns.map(w=>w.key===n?{...w,...C}:w);y(t.id,{columns:L})},F=t.type==="TABLE"&&t.props.dataSource?ie[t.props.dataSource]:[],U=t.type==="TABLE"?((le=t.props.columns)==null?void 0:le.map(n=>n.key))||[]:[];return e.jsxs("div",{className:"space-y-4 animate-fadeIn",children:[e.jsxs("div",{className:"space-y-2",children:[x("موقعیت و اندازه","layout"),!l("layout")&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-4 gap-2 text-xs",children:["x","y","width","height"].map(n=>e.jsxs("div",{children:[e.jsx("label",{className:"block text-center text-[9px] text-gray-400",children:n.toUpperCase()}),e.jsx("input",{className:"w-full p-1 border rounded text-center",type:"number",value:Math.round(t.layout[n]),onChange:C=>y(t.id,{[n]:parseInt(C.target.value)},"layout")})]},n))}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] text-gray-500 mb-1",children:"Band"}),e.jsx("select",{className:"w-full p-1 border rounded",value:t.band||"detail",onChange:n=>u(C=>({...C,elements:C.elements.map(L=>L.id===t.id?{...L,band:n.target.value}:L)})),children:ls.map(n=>e.jsx("option",{value:n,children:n},n))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] text-gray-500 mb-1",children:"Layer"}),e.jsx("input",{type:"number",className:"w-full p-1 border rounded",value:t.props.layerIndex||0,onChange:n=>y(t.id,{layerIndex:Number(n.target.value)||0})})]})]}),e.jsxs("label",{className:"flex items-center gap-2 text-xs pt-1",children:[e.jsx("input",{type:"checkbox",checked:!!t.props.locked,onChange:n=>y(t.id,{locked:n.target.checked})}),"قفل کردن المان (غیرفعال شدن جابجایی/تغییر اندازه)"]}),e.jsxs("label",{className:"flex items-center gap-2 text-xs",children:[e.jsx("input",{type:"checkbox",checked:!!t.props.pageBreakBefore,onChange:n=>y(t.id,{pageBreakBefore:n.target.checked})}),"Page Break Before"]}),e.jsxs("label",{className:"flex items-center gap-2 text-xs",children:[e.jsx("input",{type:"checkbox",checked:!!t.props.keepTogether,onChange:n=>y(t.id,{keepTogether:n.target.checked})}),"Keep Together"]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] text-gray-500 mb-1",children:"Subreport Template Id (اختیاری)"}),e.jsx("input",{className:"w-full p-1 border rounded text-xs ltr text-left",value:t.props.subreportTemplateId||"",onChange:n=>y(t.id,{subreportTemplateId:n.target.value||void 0})})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[x("ظاهر","appearance"),!l("appearance")&&e.jsxs(e.Fragment,{children:[t.type==="HEADER"&&e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"text-xs",children:"استایل کادر"}),e.jsxs("select",{className:"w-full p-1 border rounded text-xs",value:t.props.borderStyle||"NONE",onChange:n=>y(t.id,{borderStyle:n.target.value}),children:[e.jsx("option",{value:"NONE",children:"بدون کادر"}),e.jsx("option",{value:"BOX",children:"کادر کامل"}),e.jsx("option",{value:"TOP_BOTTOM",children:"خطوط بالا و پایین"}),e.jsx("option",{value:"BOTTOM",children:"فقط خط پایین"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 items-center",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs",children:"رنگ پس زمینه"}),e.jsx("input",{type:"color",className:"w-full h-8 p-0 rounded",value:t.props.backgroundColor||"#ffffff",onChange:n=>y(t.id,{backgroundColor:n.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs",children:"رنگ کادر"}),e.jsx("input",{type:"color",className:"w-full h-8 p-0 rounded",value:t.props.borderColor||"#cccccc",onChange:n=>y(t.id,{borderColor:n.target.value})})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"text-xs",children:"ضخامت کادر (px)"}),e.jsx("input",{type:"number",min:"0",max:"10",value:t.props.borderWidth||0,onChange:n=>y(t.id,{borderWidth:parseInt(n.target.value)}),className:"w-full p-1 border rounded text-xs"})]})]})]})]}),t.type!=="HEADER"&&t.type!=="TEXT"&&e.jsxs("div",{className:"space-y-2",children:[x("منبع داده","dataSource"),!l("dataSource")&&e.jsxs(e.Fragment,{children:[e.jsxs("select",{className:"w-full p-2 text-sm border rounded",value:t.props.dataSource||"",onChange:n=>y(t.id,{dataSource:n.target.value,valueField:"",labelField:""}),children:[e.jsx("option",{value:"",children:"اتصال به داده..."}),Object.keys(ie).map(n=>e.jsx("option",{value:n,children:n},n))]}),t.props.dataSource&&e.jsxs("div",{className:"bg-gray-50 p-2 rounded space-y-2",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] text-gray-500",children:"فیلد فیلتر در منبع"}),e.jsxs("select",{className:"w-full p-1 text-xs border rounded",value:t.props.filterByField||"",onChange:n=>y(t.id,{filterByField:n.target.value}),children:[e.jsx("option",{value:"",children:"بدون فیلتر"}),ie[t.props.dataSource].map(n=>e.jsx("option",{value:n,children:n},n))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] text-gray-500",children:"فیلد متناظر از رکورد"}),e.jsx("input",{type:"text",className:"w-full p-1 text-xs border rounded ltr text-left",value:t.props.filterValueFromRecordField||"",placeholder:"مثال: shift_date",onChange:n=>y(t.id,{filterValueFromRecordField:n.target.value})})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] text-gray-500",children:"حداکثر ردیف"}),e.jsx("input",{type:"number",min:1,max:500,className:"w-full p-1 text-xs border rounded",value:t.props.rowLimit||50,onChange:n=>y(t.id,{rowLimit:Number(n.target.value)||50})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] text-gray-500",children:"مرتب‌سازی بر اساس"}),e.jsxs("select",{className:"w-full p-1 text-xs border rounded",value:t.props.sortBy||"",onChange:n=>y(t.id,{sortBy:n.target.value}),children:[e.jsx("option",{value:"",children:"بدون ترتیب"}),ie[t.props.dataSource].map(n=>e.jsx("option",{value:n,children:n},n))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] text-gray-500",children:"جهت"}),e.jsxs("select",{className:"w-full p-1 text-xs border rounded",value:t.props.sortDirection||"desc",onChange:n=>y(t.id,{sortDirection:n.target.value}),children:[e.jsx("option",{value:"desc",children:"نزولی"}),e.jsx("option",{value:"asc",children:"صعودی"})]})]})]}),["CHART_BAR","CHART_PIE","CHART_LINE","CHART_AREA","CHART_RADAR"].includes(t.type)&&e.jsxs(e.Fragment,{children:[e.jsxs("select",{className:"w-full p-1 text-xs border rounded",value:t.props.labelField||"",onChange:n=>y(t.id,{labelField:n.target.value}),children:[e.jsx("option",{value:"",children:"محور X / برچسب..."}),ie[t.props.dataSource].map(n=>e.jsx("option",{value:n,children:n},n))]}),e.jsxs("select",{className:"w-full p-1 text-xs border rounded",value:t.props.valueField||"",onChange:n=>y(t.id,{valueField:n.target.value}),children:[e.jsx("option",{value:"",children:"محور Y / مقدار..."}),ie[t.props.dataSource].map(n=>e.jsx("option",{value:n,children:n},n))]}),e.jsxs("select",{className:"w-full p-1 text-xs border rounded",value:t.props.chartGroupBy||"",onChange:n=>y(t.id,{chartGroupBy:n.target.value}),children:[e.jsx("option",{value:"",children:"گروه‌بندی (اختیاری)"}),ie[t.props.dataSource].map(n=>e.jsx("option",{value:n,children:n},n))]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] text-gray-500",children:"مرتب‌سازی نمودار"}),e.jsxs("select",{className:"w-full p-1 text-xs border rounded",value:t.props.sortChartBy||"value_desc",onChange:n=>y(t.id,{sortChartBy:n.target.value}),children:[e.jsx("option",{value:"value_desc",children:"بیشترین مقدار"}),e.jsx("option",{value:"value_asc",children:"کمترین مقدار"}),e.jsx("option",{value:"label",children:"بر اساس برچسب"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] text-gray-500",children:"Top N"}),e.jsx("input",{type:"number",min:"1",max:"100",value:t.props.topN||20,onChange:n=>y(t.id,{topN:parseInt(n.target.value||"20",10)}),className:"w-full p-1 text-xs border rounded"})]})]})]}),t.type==="STAT_CARD"&&e.jsxs(e.Fragment,{children:[e.jsxs("select",{className:"w-full p-1 text-xs border rounded",value:t.props.valueField||"",onChange:n=>y(t.id,{valueField:n.target.value}),children:[e.jsx("option",{value:"",children:"فیلد مقدار..."}),ie[t.props.dataSource].map(n=>e.jsx("option",{value:n,children:n},n))]}),e.jsxs("select",{className:"w-full p-1 text-xs border rounded",value:t.props.aggregation||"COUNT",onChange:n=>y(t.id,{aggregation:n.target.value}),children:[e.jsx("option",{value:"COUNT",children:"تعداد رکورد (Count)"}),e.jsx("option",{value:"SUM",children:"مجموع مقادیر (Sum)"}),e.jsx("option",{value:"AVG",children:"میانگین مقادیر (Average)"})]})]})]})]})]}),t.type==="HEADER"&&e.jsxs("div",{className:"space-y-4",children:[x("تنظیمات هدر","header"),!l("header")&&e.jsxs(e.Fragment,{children:[e.jsx(b,{path:"titleProps",label:"عنوان اصلی"}),e.jsx(b,{path:"subtitleProps",label:"زیر عنوان"}),e.jsxs("div",{className:"space-y-2 border-t pt-4 mt-4",children:[e.jsx("h4",{className:"font-bold text-xs text-gray-500 uppercase",children:"جزئیات هدر"}),e.jsx("div",{className:"space-y-1 bg-gray-50 dark:bg-gray-900/50 p-2 rounded-lg",children:(re=t.props.detailsProps)==null?void 0:re.items.map((n,C)=>e.jsxs("div",{className:"flex items-center gap-1 bg-white dark:bg-gray-800 p-1 rounded",children:[e.jsxs("div",{className:"flex flex-col bg-gray-100 dark:bg-gray-700 rounded",children:[e.jsx("button",{type:"button",onClick:()=>kt(C,"UP"),disabled:C===0,className:"p-0.5 text-gray-400 hover:text-gray-800 disabled:opacity-30",children:e.jsx(me,{className:"w-3 h-3"})}),e.jsx("button",{type:"button",onClick:()=>kt(C,"DOWN"),disabled:C===t.props.detailsProps.items.length-1,className:"p-0.5 text-gray-400 hover:text-gray-800 disabled:opacity-30",children:e.jsx(xe,{className:"w-3 h-3"})})]}),e.jsx("input",{type:"text",placeholder:"برچسب",value:n.label,onChange:L=>{const w=[...t.props.detailsProps.items];w[C].label=L.target.value,I("detailsProps",{...t.props.detailsProps,items:w})},className:"w-1/2 p-1 border rounded text-xs"}),e.jsx("input",{type:"text",placeholder:"کلید فیلد (مثل tracking_code)",value:n.value||"",onChange:L=>{const w=[...t.props.detailsProps.items];w[C].value=L.target.value,I("detailsProps",{...t.props.detailsProps,items:w})},className:"w-1/2 p-1 border rounded text-xs ltr text-left"}),e.jsx("button",{onClick:()=>{const L=t.props.detailsProps.items.filter(w=>w.id!==n.id);I("detailsProps",{...t.props.detailsProps,items:L})},className:"p-1 text-red-500",children:e.jsx(_t,{className:"w-3 h-3"})})]},n.id))}),e.jsxs("p",{className:"text-[10px] text-gray-400",children:["برای مقدار، نام فیلد رکورد را وارد کنید (مثل ",e.jsx("span",{className:"font-mono",children:"tracking_code"}),") یا از الگو ",e.jsx("span",{className:"font-mono",children:"{{shift_date}}"})," استفاده کنید."]}),e.jsx("button",{onClick:()=>{var C;const n=[...((C=t.props.detailsProps)==null?void 0:C.items)||[],{id:Math.random().toString(),label:"جدید",value:"..."}];I("detailsProps",{...t.props.detailsProps,items:n})},className:"text-xs text-blue-600 w-full p-1 border-dashed border rounded hover:bg-blue-50",children:"+ افزودن ردیف"}),e.jsx(b,{path:"detailsProps.labelStyle",label:"استایل برچسب‌ها"}),e.jsx(b,{path:"detailsProps.valueStyle",label:"استایل مقادیر"}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs",children:"خط جداکننده"}),e.jsxs("select",{value:((Y=t.props.detailsProps)==null?void 0:Y.dividerStyle)||"dashed",onChange:n=>I("detailsProps",{...t.props.detailsProps,dividerStyle:n.target.value}),className:"w-full p-1 text-xs border rounded",children:[e.jsx("option",{value:"solid",children:"خط ممتد"}),e.jsx("option",{value:"dashed",children:"خط‌چین"}),e.jsx("option",{value:"none",children:"بدون خط"})]})]})]}),e.jsxs("div",{className:"space-y-2 border-t pt-4 mt-4",children:[e.jsx("h4",{className:"font-bold text-xs text-gray-500 uppercase",children:"لوگو"}),e.jsxs("div",{className:"flex gap-2 bg-gray-100 p-1 rounded-lg",children:[e.jsx("button",{type:"button",onClick:()=>y(t.id,{logoType:"DEFAULT"}),className:`flex-1 text-xs p-1 rounded ${t.props.logoType!=="CUSTOM"?"bg-white shadow":""}`,children:"پیش‌فرض"}),e.jsx("button",{type:"button",onClick:()=>y(t.id,{logoType:"CUSTOM"}),className:`flex-1 text-xs p-1 rounded ${t.props.logoType==="CUSTOM"?"bg-white shadow":""}`,children:"سفارشی"})]}),t.props.logoType==="CUSTOM"&&e.jsxs("div",{className:"p-2 border-t",children:[e.jsx("input",{type:"file",ref:ot,className:"hidden",accept:"image/png, image/jpeg, image/svg+xml",onChange:fa}),e.jsxs("button",{type:"button",onClick:()=>{var n;return(n=ot.current)==null?void 0:n.click()},className:"w-full flex items-center justify-center gap-2 bg-blue-50 text-blue-600 p-2 rounded hover:bg-blue-100",children:[e.jsx(pt,{className:"w-4 h-4"})," بارگذاری لوگو"]}),t.props.customLogo&&e.jsx("img",{src:t.props.customLogo,className:"w-16 h-16 object-contain mx-auto mt-2 border p-1 rounded"})]})]})]})]}),t.type==="TEXT"&&e.jsxs("div",{className:"space-y-2",children:[x("استایل متن","text"),!l("text")&&e.jsx(b,{path:"textProps",label:"استایل متن"})]}),t.type==="IMAGE"&&e.jsxs("div",{className:"space-y-3",children:[x("تنظیمات تصویر","image"),!l("image")&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{type:"button",onClick:()=>{var n;return(n=ot.current)==null?void 0:n.click()},className:"w-full flex items-center justify-center gap-2 bg-blue-50 text-blue-600 p-2 rounded hover:bg-blue-100",children:[e.jsx(pt,{className:"w-4 h-4"})," بارگذاری تصویر"]}),e.jsxs("select",{className:"w-full p-2 text-xs border rounded",value:t.props.imageFit||"contain",onChange:n=>y(t.id,{imageFit:n.target.value}),children:[e.jsx("option",{value:"contain",children:"Contain (نمایش کامل)"}),e.jsx("option",{value:"cover",children:"Cover (پر کردن کادر)"}),e.jsx("option",{value:"fill",children:"Fill (کشیدگی کامل)"})]})]})]}),t.type==="STAT_CARD"&&e.jsxs("div",{className:"space-y-4",children:[x("تنظیمات کارت آمار","stat"),!l("stat")&&e.jsxs(e.Fragment,{children:[e.jsx(b,{path:"labelProps",label:"استایل برچسب"}),e.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[e.jsx("input",{type:"checkbox",checked:((ve=t.props.labelProps)==null?void 0:ve.highlight)||!1,onChange:n=>I("labelProps",{...t.props.labelProps,highlight:n.target.checked})})," ",e.jsx("label",{children:"هایلایت کردن برچسب"})]}),t.props.dataSource&&t.props.valueField?e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"p-3 border rounded-lg bg-gray-100 dark:bg-gray-900/50 text-center",children:e.jsx("span",{className:"text-xs text-gray-500",children:"مقدار از منبع داده خوانده می‌شود."})}),e.jsx(b,{path:"valueProps",label:"استایل مقدار",disableText:!0})]}):e.jsx(b,{path:"valueProps",label:"مقدار (دستی)"}),e.jsx(b,{path:"unitProps",label:"استایل واحد"}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs",children:"جداکننده"}),e.jsxs("select",{value:t.props.divider||"NONE",onChange:n=>y(t.id,{divider:n.target.value}),className:"w-full p-1 text-xs border rounded",children:[e.jsx("option",{value:"NONE",children:"بدون خط"}),e.jsx("option",{value:"MIDDLE",children:"خط وسط"})]})]}),e.jsxs("div",{className:"space-y-2 border-t pt-4 mt-4",children:[e.jsx("h4",{className:"font-bold text-xs text-gray-500 uppercase",children:"نوار پیشرفت هدف"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:((E=t.props.goalProps)==null?void 0:E.show)||!1,onChange:n=>I("goalProps",{...t.props.goalProps,show:n.target.checked})})," ",e.jsx("label",{className:"text-xs",children:"نمایش نوار پیشرفت"})]}),((J=t.props.goalProps)==null?void 0:J.show)&&e.jsxs("div",{className:"space-y-2 bg-gray-50 p-2 rounded",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs",children:"برچسب"}),e.jsx("input",{type:"text",value:((H=t.props.goalProps)==null?void 0:H.label)||"",onChange:n=>I("goalProps",{...t.props.goalProps,label:n.target.value}),className:"w-full p-1 text-xs border rounded"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs",children:"مقدار هدف"}),e.jsx("input",{type:"number",value:((q=t.props.goalProps)==null?void 0:q.value)||0,onChange:n=>I("goalProps",{...t.props.goalProps,value:parseInt(n.target.value)}),className:"w-full p-1 text-xs border rounded"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs",children:"رنگ نوار"}),e.jsx("input",{type:"color",value:((qe=t.props.goalProps)==null?void 0:qe.color)||"#10b981",onChange:n=>I("goalProps",{...t.props.goalProps,color:n.target.value}),className:"w-full h-8 p-0 rounded"})]})]})]})]})]}),t.type==="TABLE"&&e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"space-y-2",children:[x("تنظیمات جدول","table"),!l("table")&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-bold text-xs text-gray-500 uppercase",children:"مدیریت ستون‌ها"}),e.jsx("div",{className:"space-y-2 bg-gray-50 p-2 rounded max-h-60 overflow-y-auto",children:F.map(n=>{var w;const C=U.includes(n),L=(w=t.props.columns)==null?void 0:w.find(B=>B.key===n);return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:C,onChange:B=>h(n,B.target.checked)}),e.jsx("span",{className:"text-xs flex-1",children:n})]}),C&&L&&e.jsxs("div",{className:"pr-6 mt-1 space-y-1",children:[e.jsx("input",{type:"text",placeholder:"عنوان ستون...",value:L.header,onChange:B=>m(n,{header:B.target.value}),className:"w-full p-1 border rounded text-xs"}),e.jsx("div",{className:"flex bg-gray-200 rounded p-0.5",children:["right","center","left"].map(B=>e.jsx("button",{type:"button",onClick:()=>m(n,{align:B}),className:`p-1 rounded ${L.align===B?"bg-white shadow":""}`,children:B==="right"?e.jsx(gt,{className:"w-4 h-4"}):B==="center"?e.jsx(xt,{className:"w-4 h-4"}):e.jsx(mt,{className:"w-4 h-4"})},B))})]})]},n)})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-bold text-xs text-gray-500 uppercase",children:"استایل"}),e.jsx(b,{path:"headerStyle",label:"استایل هدر"}),e.jsxs("div",{className:"pl-4 -mt-2 space-y-1",children:[e.jsx("label",{className:"text-xs",children:"رنگ پس زمینه هدر"}),e.jsx("input",{type:"color",className:"w-full h-8 p-0 rounded",value:((Me=t.props.headerStyle)==null?void 0:Me.backgroundColor)||"#f3f4f6",onChange:n=>I("headerStyle",{...t.props.headerStyle,backgroundColor:n.target.value})})]}),e.jsx(b,{path:"rowStyle",label:"استایل ردیف‌ها"}),e.jsxs("div",{className:"pl-4 -mt-2 space-y-1",children:[e.jsx("label",{className:"text-xs",children:"رنگ ردیف جایگزین"}),e.jsx("input",{type:"color",className:"w-full h-8 p-0 rounded",value:t.props.alternateRowColor||"#fafafa",onChange:n=>y(t.id,{alternateRowColor:n.target.value})})]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[e.jsx("input",{type:"checkbox",checked:t.props.showRowNumber||!1,onChange:n=>y(t.id,{showRowNumber:n.target.checked})})," ",e.jsx("label",{children:"نمایش شماره ردیف"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[e.jsx("input",{type:"checkbox",checked:t.props.showTableBorders!==!1,onChange:n=>y(t.id,{showTableBorders:n.target.checked})})," ",e.jsx("label",{children:"نمایش خطوط جدول"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[e.jsx("input",{type:"checkbox",checked:t.props.compactRows||!1,onChange:n=>y(t.id,{compactRows:n.target.checked})})," ",e.jsx("label",{children:"حالت فشرده"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[e.jsx("input",{type:"checkbox",checked:t.props.wrapText!==!1,onChange:n=>y(t.id,{wrapText:n.target.checked})})," ",e.jsx("label",{children:"شکستن متن سلول‌ها"})]}),e.jsxs("div",{className:"space-y-1 border rounded p-2 bg-gray-50",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[e.jsx("input",{type:"checkbox",checked:t.props.showTotalsRow||!1,onChange:n=>y(t.id,{showTotalsRow:n.target.checked})}),e.jsx("label",{children:"نمایش ردیف جمع ستون‌ها"})]}),(t.props.showTotalsRow||!1)&&e.jsx("div",{className:"grid grid-cols-2 gap-1 max-h-28 overflow-y-auto",children:F.map(n=>e.jsxs("label",{className:"text-[11px] flex items-center gap-1",children:[e.jsx("input",{type:"checkbox",checked:(t.props.totalFields||[]).includes(n),onChange:C=>{const L=t.props.totalFields||[],w=C.target.checked?[...new Set([...L,n])]:L.filter(B=>B!==n);y(t.id,{totalFields:w})}}),n]},n))})]})]})]})]})}),["CHART_BAR","CHART_PIE","CHART_LINE","CHART_AREA","CHART_RADAR"].includes(t.type)&&e.jsxs("div",{className:"space-y-4",children:[x("تنظیمات نمودار","chart"),!l("chart")&&e.jsxs(e.Fragment,{children:[e.jsx(b,{path:"titleProps",label:"استایل عنوان نمودار"}),e.jsxs("div",{className:"space-y-2 border-t pt-4 mt-4",children:[e.jsx("h4",{className:"font-bold text-xs text-gray-500 uppercase",children:"تنظیمات ظاهری نمودار"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:t.props.showLegend||!1,onChange:n=>y(t.id,{showLegend:n.target.checked})})," ",e.jsx("label",{className:"text-xs",children:"نمایش راهنما (Legend)"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:t.props.showGrid!==!1,onChange:n=>y(t.id,{showGrid:n.target.checked})})," ",e.jsx("label",{className:"text-xs",children:"نمایش خطوط شبکه"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:t.props.showTooltip!==!1,onChange:n=>y(t.id,{showTooltip:n.target.checked})})," ",e.jsx("label",{className:"text-xs",children:"نمایش Tooltip"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs",children:"پالت رنگی (با کاما جدا کنید)"}),e.jsx("input",{type:"text",className:"w-full p-1 text-xs border rounded ltr text-left",value:t.props.chartPalette||"",onChange:n=>y(t.id,{chartPalette:n.target.value}),placeholder:"#800020,#2563eb,#10b981"})]}),t.type==="CHART_BAR"&&e.jsxs("div",{children:[e.jsx("label",{className:"text-xs",children:"گردی گوشه ستون‌ها"}),e.jsx("input",{type:"number",min:"0",max:"20",value:t.props.barRadius||0,onChange:n=>y(t.id,{barRadius:parseInt(n.target.value)}),className:"w-full p-1 text-xs border rounded"})]}),t.type==="CHART_PIE"&&e.jsxs("div",{children:[e.jsx("label",{className:"text-xs",children:"شعاع داخلی (برای حالت دونات)"}),e.jsx("input",{type:"number",min:"0",max:"50",value:t.props.innerRadius||0,onChange:n=>y(t.id,{innerRadius:parseInt(n.target.value)}),className:"w-full p-1 text-xs border rounded"})]}),t.type==="CHART_PIE"&&e.jsxs("div",{children:[e.jsx("label",{className:"text-xs",children:"برچسب روی نمودار"}),e.jsxs("select",{value:t.props.pieLabelMode||"none",onChange:n=>y(t.id,{pieLabelMode:n.target.value}),className:"w-full p-1 text-xs border rounded",children:[e.jsx("option",{value:"none",children:"بدون برچسب"}),e.jsx("option",{value:"value",children:"نمایش مقدار"}),e.jsx("option",{value:"percent",children:"نمایش درصد"})]})]}),(t.type==="CHART_LINE"||t.type==="CHART_AREA")&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs",children:"نوع خط"}),e.jsxs("select",{value:t.props.lineType||"monotone",onChange:n=>y(t.id,{lineType:n.target.value}),className:"w-full p-1 text-xs border rounded",children:[e.jsx("option",{value:"monotone",children:"صاف (Smooth)"}),e.jsx("option",{value:"linear",children:"شکسته (Linear)"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:t.props.showDots===void 0?!0:t.props.showDots,onChange:n=>y(t.id,{showDots:n.target.checked})})," ",e.jsx("label",{className:"text-xs",children:"نمایش نقاط داده"})]})]}),t.type==="CHART_AREA"&&e.jsxs("div",{children:[e.jsx("label",{className:"text-xs",children:"شفافیت ناحیه"}),e.jsx("input",{type:"number",min:"0",max:"1",step:"0.05",value:t.props.areaOpacity??.35,onChange:n=>y(t.id,{areaOpacity:parseFloat(n.target.value)}),className:"w-full p-1 text-xs border rounded"})]}),(t.type==="CHART_BAR"||t.type==="CHART_AREA")&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:t.props.stacked||!1,onChange:n=>y(t.id,{stacked:n.target.checked})})," ",e.jsx("label",{className:"text-xs",children:"حالت تجمعی (Stacked)"})]})]})]})]}),e.jsxs("div",{className:"border-t pt-4 mt-4",children:[x("عملیات","actions"),!l("actions")&&e.jsxs("button",{onClick:()=>Ct(t.id),className:"w-full flex items-center justify-center gap-2 bg-red-50 text-red-600 p-2 rounded-lg hover:bg-red-100 transition",children:[e.jsx(_t,{className:"w-4 h-4"})," حذف المان"]})]})]})};return r==="LIST"?e.jsx(Sa,{title:"طراحی قالب گزارش",icon:Tt,data:o,columns:ha,isLoading:!1,selectedIds:Ge,onSelect:Ue,onAdd:xa,onReload:pe,onEdit:ma,onDelete:async t=>{t.forEach(l=>Lt(l)),pe()},customRowActions:t=>e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:l=>{l.stopPropagation(),pa(t.id,t.targetModule),pe()},disabled:t.isActive,className:"text-xs px-2 py-1 rounded bg-green-50 text-green-700 disabled:opacity-40 hover:bg-green-100",children:"فعال‌سازی"}),e.jsx("button",{onClick:l=>{l.stopPropagation(),ua(t.id),pe()},className:"text-xs px-2 py-1 rounded bg-red-50 text-red-700 hover:bg-red-100",children:"حذف"})]}),exportName:"ReportTemplates"}):e.jsxs("div",{className:"h-[calc(100vh-80px)] flex flex-col bg-gray-100 dark:bg-gray-900 overflow-hidden",children:[e.jsxs("div",{className:"h-14 bg-white dark:bg-gray-800 border-b px-4 flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("button",{onClick:ga,className:"px-3 py-1.5 rounded-lg text-sm font-bold bg-gray-100 text-gray-700 hover:bg-gray-200 flex items-center gap-2",children:[e.jsx(Ta,{className:"w-4 h-4 rotate-180"}),"بازگشت به لیست"]})}),e.jsx("div",{className:"text-xs text-gray-500",children:"هر گزارش فقط یک قالب فعال دارد."})]}),e.jsxs("div",{className:"flex flex-1 overflow-hidden",children:[e.jsxs("div",{className:"w-56 bg-white dark:bg-gray-800 border-l flex flex-col z-20",children:[e.jsx("div",{className:"p-4 border-b",children:e.jsxs("h2",{className:"font-bold flex items-center gap-2",children:[e.jsx(Tt,{className:"w-5 h-5 text-primary"})," ابزارها"]})}),e.jsxs("div",{className:"flex-1 p-2 space-y-2 overflow-y-auto",children:[e.jsxs("button",{type:"button",onClick:()=>Q(t=>({...t,base:!t.base})),className:"w-full flex items-center justify-between px-2 py-1 rounded text-[10px] text-gray-500 font-bold uppercase bg-gray-50 hover:bg-gray-100",children:[e.jsx("span",{children:"پایه"}),V.base?e.jsx(xe,{className:"w-3 h-3"}):e.jsx(me,{className:"w-3 h-3"})]}),!V.base&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("button",{onClick:()=>oe("HEADER"),className:"w-full flex items-center gap-2 p-2 bg-gray-50 hover:bg-blue-50 rounded text-sm",children:[e.jsx(Ra,{className:"w-4 h-4"})," هدر"]}),e.jsxs("button",{onClick:()=>oe("TEXT"),className:"w-full flex items-center gap-2 p-2 bg-gray-50 hover:bg-blue-50 rounded text-sm",children:[e.jsx(fr,{className:"w-4 h-4"})," متن"]}),e.jsxs("button",{onClick:()=>oe("IMAGE"),className:"w-full flex items-center gap-2 p-2 bg-gray-50 hover:bg-blue-50 rounded text-sm",children:[e.jsx(Rt,{className:"w-4 h-4"})," تصویر"]})]}),e.jsxs("button",{type:"button",onClick:()=>Q(t=>({...t,data:!t.data})),className:"w-full flex items-center justify-between px-2 py-1 rounded text-[10px] text-gray-500 font-bold uppercase bg-gray-50 hover:bg-gray-100",children:[e.jsx("span",{children:"داده"}),V.data?e.jsx(xe,{className:"w-3 h-3"}):e.jsx(me,{className:"w-3 h-3"})]}),!V.data&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("button",{onClick:()=>oe("STAT_CARD"),className:"w-full flex items-center gap-2 p-2 bg-gray-50 hover:bg-blue-50 rounded text-sm",children:[e.jsx(mr,{className:"w-4 h-4"})," کارت آمار"]}),e.jsxs("button",{onClick:()=>oe("TABLE"),className:"w-full flex items-center gap-2 p-2 bg-gray-50 hover:bg-blue-50 rounded text-sm",children:[e.jsx(gr,{className:"w-4 h-4"})," جدول"]})]}),e.jsxs("button",{type:"button",onClick:()=>Q(t=>({...t,charts:!t.charts})),className:"w-full flex items-center justify-between px-2 py-1 rounded text-[10px] text-gray-500 font-bold uppercase bg-gray-50 hover:bg-gray-100",children:[e.jsx("span",{children:"نمودار"}),V.charts?e.jsx(xe,{className:"w-3 h-3"}):e.jsx(me,{className:"w-3 h-3"})]}),!V.charts&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("button",{onClick:()=>oe("CHART_BAR"),className:"w-full flex items-center gap-2 p-2 bg-gray-50 hover:bg-blue-50 rounded text-sm",children:[e.jsx(Mt,{className:"w-4 h-4"})," میله‌ای"]}),e.jsxs("button",{onClick:()=>oe("CHART_PIE"),className:"w-full flex items-center gap-2 p-2 bg-gray-50 hover:bg-blue-50 rounded text-sm",children:[e.jsx(Oa,{className:"w-4 h-4"})," دایره‌ای"]}),e.jsxs("button",{onClick:()=>oe("CHART_LINE"),className:"w-full flex items-center gap-2 p-2 bg-gray-50 hover:bg-blue-50 rounded text-sm",children:[e.jsx(Ot,{className:"w-4 h-4"})," خطی"]}),e.jsxs("button",{onClick:()=>oe("CHART_AREA"),className:"w-full flex items-center gap-2 p-2 bg-gray-50 hover:bg-blue-50 rounded text-sm",children:[e.jsx(Ot,{className:"w-4 h-4"})," ناحیه‌ای"]}),e.jsxs("button",{onClick:()=>oe("CHART_RADAR"),className:"w-full flex items-center gap-2 p-2 bg-gray-50 hover:bg-blue-50 rounded text-sm",children:[e.jsx(Mt,{className:"w-4 h-4"})," رادار"]})]})]})]}),e.jsxs("div",{className:"flex-1 flex flex-col bg-gray-200/50 dark:bg-gray-900/50",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 border-b px-6 py-3 z-10 space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[e.jsx("input",{type:"text",value:c.title,onChange:t=>u({...c,title:t.target.value}),className:"font-bold text-lg bg-transparent outline-none w-72 max-w-full"}),e.jsx("select",{value:c.targetModule,onChange:t=>Xe(t.target.value),className:"text-sm bg-gray-100 dark:bg-gray-700 rounded px-2 py-1 border-none outline-none",children:Ve.map(t=>e.jsx("option",{value:t.id,children:t.label},t.id))})]}),e.jsxs("button",{onClick:sa,className:"px-5 py-2 bg-primary text-white rounded-lg text-sm font-bold shadow-lg flex items-center gap-2 shrink-0",title:"ذخیره نسخه جدید قالب",children:[e.jsx(Ea,{className:"w-4 h-4"})," ذخیره نسخه جدید"]})]}),e.jsxs("div",{className:"flex items-center justify-between gap-2 overflow-x-auto pb-1",children:[e.jsxs("div",{className:"flex items-center gap-1 border-r pr-3 mr-1 shrink-0",children:[e.jsx("button",{onClick:na,disabled:O.length===0,className:"p-1.5 rounded bg-gray-100 hover:bg-gray-200 disabled:opacity-40 transition-colors",title:"بازگشت",children:e.jsx(_a,{className:"w-4 h-4"})}),e.jsx("button",{onClick:oa,disabled:T.length===0,className:"p-1.5 rounded bg-gray-100 hover:bg-gray-200 disabled:opacity-40 transition-colors",title:"انجام مجدد",children:e.jsx(La,{className:"w-4 h-4"})}),e.jsx("button",{onClick:la,disabled:!k,className:"p-1.5 rounded bg-gray-100 hover:bg-gray-200 disabled:opacity-40 transition-colors",title:"کپی المان",children:e.jsx(Da,{className:"w-4 h-4"})}),e.jsx("button",{onClick:ia,disabled:!k,className:`p-1.5 rounded disabled:opacity-40 transition-colors ${k!=null&&k.props.locked?"bg-amber-100 text-amber-700 hover:bg-amber-200":"bg-gray-100 hover:bg-gray-200"}`,title:k!=null&&k.props.locked?"باز کردن قفل المان":"قفل کردن المان",children:k!=null&&k.props.locked?e.jsx(Ma,{className:"w-4 h-4"}):e.jsx(Ia,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"flex items-center gap-1 border-r pr-3 mr-1 shrink-0",children:[e.jsx("button",{onClick:()=>it("left"),disabled:!k,className:"p-1.5 rounded bg-gray-100 hover:bg-gray-200 disabled:opacity-40 transition-colors",title:"تراز به چپ",children:e.jsx(gt,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>it("center-x"),disabled:!k,className:"p-1.5 rounded bg-gray-100 hover:bg-gray-200 disabled:opacity-40 transition-colors",title:"تراز وسط افقی",children:e.jsx(xt,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>it("right"),disabled:!k,className:"p-1.5 rounded bg-gray-100 hover:bg-gray-200 disabled:opacity-40 transition-colors",title:"تراز به راست",children:e.jsx(mt,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"flex items-center gap-1 shrink-0 mx-auto",children:[e.jsxs("button",{onClick:()=>$(t=>!t),className:`px-3 py-1 rounded-full text-xs font-bold transition-colors inline-flex items-center gap-1 ${_?"bg-blue-100 text-blue-700 ring-1 ring-blue-300":"bg-gray-100 text-gray-700"}`,title:"مغناطیسی کردن چینش",children:[e.jsx(Ba,{className:"w-3.5 h-3.5"}),_?"مغناطیس روشن":"مغناطیس خاموش"]}),e.jsxs("button",{onClick:()=>Z(t=>!t),className:`px-3 py-1 rounded-full text-xs font-bold transition-colors inline-flex items-center gap-1 ${M?"bg-emerald-100 text-emerald-700 ring-1 ring-emerald-300":"bg-gray-100 text-gray-700"}`,title:"نمایش خطوط راهنما",children:[e.jsx($a,{className:"w-3.5 h-3.5"}),M?"شبکه روشن":"شبکه خاموش"]}),e.jsxs("button",{onClick:()=>ae(t=>!t),className:`px-3 py-1 rounded-full text-xs font-bold transition-colors inline-flex items-center gap-1 ${z?"bg-violet-100 text-violet-700 ring-1 ring-violet-300":"bg-gray-100 text-gray-700"}`,title:"نمایش خط‌کش",children:[e.jsx(xr,{className:"w-3.5 h-3.5"}),z?"خط‌کش روشن":"خط‌کش خاموش"]}),e.jsxs("button",{onClick:()=>be(t=>!t),className:`px-3 py-1 rounded-full text-xs font-bold transition-colors inline-flex items-center gap-1 ${K?"bg-orange-100 text-orange-700 ring-1 ring-orange-300":"bg-gray-100 text-gray-700"}`,title:"نمایش پنل لایه‌ها",children:[e.jsx(Fa,{className:"w-3.5 h-3.5"}),K?"لایه‌ها روشن":"لایه‌ها خاموش"]})]}),e.jsxs("div",{className:"flex items-center gap-1 shrink-0",children:[e.jsx("button",{onClick:ca,className:"p-1.5 rounded bg-gray-100 hover:bg-gray-200 transition-colors",title:"خروجی قالب (JSON)",children:e.jsx(za,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>{var t;return(t=jt.current)==null?void 0:t.click()},className:"p-1.5 rounded bg-gray-100 hover:bg-gray-200 transition-colors",title:"ورود قالب (JSON)",children:e.jsx(pt,{className:"w-4 h-4"})}),e.jsx("input",{ref:jt,type:"file",className:"hidden",accept:"application/json",onChange:da})]})]})]}),e.jsx("div",{className:"flex-1 overflow-auto p-8 flex justify-center items-start",onClick:()=>g(null),children:e.jsx("div",{ref:Nt,className:"bg-white shadow-2xl relative",style:{width:"210mm",height:"297mm",padding:"1mm"},children:c.elements.map(t=>e.jsxs("div",{onClick:l=>{l.stopPropagation(),g(t.id)},onMouseDown:l=>At(l,"move",t),style:{position:"absolute",left:t.layout.x,top:t.layout.y,width:t.layout.width,height:t.layout.height,border:`1px ${f===t.id?"dashed #3b82f6":"solid transparent"}`,cursor:t.props.locked?"not-allowed":"grab"},children:[Na(t),f===t.id&&!t.props.locked&&[{id:"br",style:{right:-6,bottom:-6},cursor:"se-resize"},{id:"bl",style:{left:-6,bottom:-6},cursor:"sw-resize"},{id:"tr",style:{right:-6,top:-6},cursor:"ne-resize"},{id:"tl",style:{left:-6,top:-6},cursor:"nw-resize"},{id:"r",style:{right:-6,top:"50%",transform:"translateY(-50%)"},cursor:"e-resize"},{id:"l",style:{left:-6,top:"50%",transform:"translateY(-50%)"},cursor:"w-resize"},{id:"t",style:{top:-6,left:"50%",transform:"translateX(-50%)"},cursor:"n-resize"},{id:"b",style:{bottom:-6,left:"50%",transform:"translateX(-50%)"},cursor:"s-resize"}].map(l=>e.jsx("div",{onMouseDown:d=>At(d,`resize-${l.id}`,t),className:"absolute w-3 h-3 bg-white border-2 border-primary rounded-full",style:{...l.style,cursor:l.cursor}},l.id)),f===t.id&&t.props.locked&&e.jsx("div",{className:"absolute top-1 left-1 text-[10px] bg-amber-100 text-amber-700 px-1.5 py-0.5 rounded",children:"قفل"})]},t.id))})})]}),e.jsxs("div",{className:"w-72 bg-white dark:bg-gray-800 border-r flex flex-col z-20",children:[e.jsxs("div",{className:"p-4 border-b bg-gray-50 space-y-2",children:[e.jsxs("h2",{className:"font-bold flex items-center gap-2",children:[e.jsx(Ha,{className:"w-5 h-5 text-gray-500"})," تنظیمات"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{type:"button",onClick:()=>wt(!1),className:"flex-1 text-xs py-1.5 rounded bg-blue-50 text-blue-700 hover:bg-blue-100",children:"باز کردن همه"}),e.jsx("button",{type:"button",onClick:()=>wt(!0),className:"flex-1 text-xs py-1.5 rounded bg-gray-100 text-gray-700 hover:bg-gray-200",children:"بستن همه"})]})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4",children:[wa(),Aa()]})]})]})]})};export{xs as ReportTemplateDesign,xs as default};
