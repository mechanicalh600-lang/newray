import{r as o,as as h,j as e,aF as f,Y as g,aG as N,F as w,aH as c,U as p,V as k,aI as x,aJ as S}from"./index-Ba5jVD6p.js";import{P as C}from"./play-BMO1cnzw.js";const E=()=>{const[b,m]=o.useState([]),[s,r]=o.useState(null);o.useEffect(()=>{m(h())},[]);const u=()=>{const t={id:x(),title:"فرآیند جدید",module:"WORK_ORDER",isActive:!1,steps:[]};r(t)},j=()=>{s&&(S(s),m(h()),alert("فرآیند با موفقیت ذخیره شد."))},v=()=>{if(!s)return;const t={id:x(),title:"مرحله جدید",assigneeRole:p.ADMIN,actions:[]};r({...s,steps:[...s.steps,t]})},y=t=>{if(!s)return;const d={id:x(),label:"تایید و ادامه",nextStepId:"FINISH",style:"primary"};r({...s,steps:s.steps.map(a=>a.id!==t?a:{...a,actions:[...a.actions,d]})})};return s?e.jsxs("div",{className:"max-w-6xl mx-auto pb-20 h-[calc(100vh-100px)] flex flex-col",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-xl shadow-sm mb-6 flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>r(null),className:"text-gray-500 hover:text-gray-800",children:"بازگشت"}),e.jsx("div",{className:"h-8 w-px bg-gray-300"}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-500 block",children:"نام فرآیند"}),e.jsx("input",{value:s.title,onChange:t=>r({...s,title:t.target.value}),className:"font-bold bg-transparent outline-none border-b border-dashed border-gray-300 focus:border-primary"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-500 block",children:"ماژول هدف"}),e.jsxs("select",{value:s.module,onChange:t=>r({...s,module:t.target.value}),className:"bg-gray-50 dark:bg-gray-700 rounded p-1 text-sm outline-none",children:[e.jsx("option",{value:"WORK_ORDER",children:"دستور کار (Work Order)"}),e.jsx("option",{value:"PROJECT",children:"پروژه‌ها (Project)"}),e.jsx("option",{value:"PART_REQUEST",children:"درخواست قطعه"}),e.jsx("option",{value:"PURCHASE",children:"درخواست خرید"}),e.jsx("option",{value:"PERFORMANCE",children:"امتیاز عملکرد"}),e.jsx("option",{value:"MEETING",children:"صورتجلسات"}),e.jsx("option",{value:"SUGGESTION",children:"پیشنهادات"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer text-sm",children:[e.jsx("input",{type:"checkbox",checked:s.isActive,onChange:t=>r({...s,isActive:t.target.checked}),className:"w-4 h-4 text-primary rounded"}),"فعال سازی"]}),e.jsxs("button",{onClick:j,className:"bg-green-600 text-white px-4 py-2 rounded-lg flex items-center gap-2 hover:bg-green-700 shadow",children:[e.jsx(w,{className:"w-4 h-4"})," ذخیره تغییرات"]})]})]}),e.jsx("div",{className:"flex-1 overflow-x-auto overflow-y-auto bg-gray-100 dark:bg-gray-900 rounded-xl p-6 border border-dashed border-gray-300 relative",children:e.jsxs("div",{className:"flex gap-8 min-w-max",children:[e.jsxs("div",{className:"w-16 flex flex-col items-center justify-center pt-20 opacity-50",children:[e.jsx("div",{className:"w-12 h-12 bg-green-500 rounded-full flex items-center justify-center text-white shadow-lg mb-2",children:e.jsx(C,{className:"w-6 h-6 ml-1"})}),e.jsx("span",{className:"text-xs font-bold",children:"شروع"})]}),e.jsx(c,{className:"w-8 h-8 text-gray-300 self-center mt-8"}),s.steps.map((t,d)=>e.jsxs("div",{className:"flex gap-4 items-center",children:[e.jsxs("div",{className:"w-80 bg-white dark:bg-gray-800 rounded-xl shadow-lg border-t-4 border-primary flex flex-col",children:[e.jsxs("div",{className:"p-4 border-b dark:border-gray-700 flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("input",{value:t.title,onChange:a=>{const l=[...s.steps];l[d].title=a.target.value,r({...s,steps:l})},className:"font-bold text-gray-800 dark:text-white bg-transparent outline-none w-full",placeholder:"عنوان مرحله"}),e.jsxs("div",{className:"mt-2",children:[e.jsx("label",{className:"text-xs text-gray-500",children:"مسئول انجام:"}),e.jsxs("select",{value:t.assigneeRole,onChange:a=>{const l=[...s.steps];l[d].assigneeRole=a.target.value,r({...s,steps:l})},className:"block w-full mt-1 text-sm bg-gray-50 dark:bg-gray-700 p-1 rounded",children:[Object.values(p).map(a=>e.jsx("option",{value:a,children:a},a)),e.jsx("option",{value:"INITIATOR",children:"ثبت کننده (Initiator)"})]})]})]}),e.jsx("button",{onClick:()=>{const a=s.steps.filter(l=>l.id!==t.id);r({...s,steps:a})},className:"text-red-400 hover:text-red-600",children:e.jsx(k,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-700/30 flex-1 space-y-2",children:[e.jsx("p",{className:"text-xs font-bold text-gray-500 mb-2",children:"اقدامات (Actions):"}),t.actions.map((a,l)=>e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-2 rounded border border-gray-200 dark:border-gray-600 text-sm space-y-2",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{value:a.label,onChange:n=>{const i=[...s.steps];i[d].actions[l].label=n.target.value,r({...s,steps:i})},className:"flex-1 bg-transparent border-b border-dashed outline-none",placeholder:"نام دکمه"}),e.jsxs("select",{value:a.style,onChange:n=>{const i=[...s.steps];i[d].actions[l].style=n.target.value,r({...s,steps:i})},className:"text-xs bg-gray-100 rounded",children:[e.jsx("option",{value:"primary",children:"آبی"}),e.jsx("option",{value:"success",children:"سبز"}),e.jsx("option",{value:"danger",children:"قرمز"}),e.jsx("option",{value:"neutral",children:"طوسی"})]})]}),e.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-500",children:[e.jsx(c,{className:"w-3 h-3"}),e.jsx("span",{children:"برو به:"}),e.jsxs("select",{value:a.nextStepId,onChange:n=>{const i=[...s.steps];i[d].actions[l].nextStepId=n.target.value,r({...s,steps:i})},className:"bg-transparent font-medium text-gray-800 dark:text-gray-200 outline-none",children:[e.jsx("option",{value:"FINISH",children:"پایان فرآیند"}),s.steps.map(n=>e.jsx("option",{value:n.id,children:n.title},n.id))]})]})]},a.id)),e.jsx("button",{onClick:()=>y(t.id),className:"w-full py-1 text-xs text-primary border border-dashed border-primary/30 rounded hover:bg-primary/5",children:"+ افزودن اقدام"})]})]}),e.jsx(c,{className:"w-8 h-8 text-gray-300"})]},t.id)),e.jsxs("button",{onClick:v,className:"h-80 w-40 border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-xl flex flex-col items-center justify-center text-gray-400 hover:border-primary hover:text-primary transition bg-white/50",children:[e.jsx(g,{className:"w-8 h-8 mb-2"}),e.jsx("span",{children:"مرحله جدید"})]})]})})]}):e.jsxs("div",{className:"max-w-6xl mx-auto space-y-6 pb-20",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("h1",{className:"text-2xl font-bold flex items-center gap-2",children:[e.jsx(f,{className:"text-primary"})," طراحی فرآیندهای کاری"]}),e.jsxs("button",{onClick:u,className:"bg-primary text-white px-4 py-2 rounded-lg flex items-center gap-2",children:[e.jsx(g,{className:"w-4 h-4"})," فرآیند جدید"]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:b.map(t=>e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-xl shadow-sm border border-gray-100 dark:border-gray-700 hover:shadow-md transition",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsx("div",{className:"p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg text-blue-600",children:e.jsx(N,{className:"w-6 h-6"})}),e.jsx("span",{className:`px-2 py-1 rounded text-xs font-bold ${t.isActive?"bg-green-100 text-green-700":"bg-gray-100 text-gray-500"}`,children:t.isActive?"فعال":"پیش‌نویس"})]}),e.jsx("h3",{className:"font-bold text-lg mb-1",children:t.title}),e.jsxs("p",{className:"text-sm text-gray-500 mb-4",children:["ماژول: ",t.module]}),e.jsxs("p",{className:"text-xs text-gray-400 mb-4",children:[t.steps.length," مرحله تعریف شده"]}),e.jsx("button",{onClick:()=>r(t),className:"w-full py-2 border border-primary text-primary rounded-lg hover:bg-primary hover:text-white transition",children:"ویرایش فرآیند"})]},t.id))})]})};export{E as WorkflowDesigner,E as default};
