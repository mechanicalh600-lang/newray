import{c as C,u as S,h as A,i as R,k as I,r as l,s as n,W as D,l as E,P as z,A as T,j as e,m as x,t as m,M as _,n as q,o as L,p as W}from"./index-Ba5jVD6p.js";import{C as M}from"./coffee-CK5ktbjd.js";import{R as g,B as $,C as b,X as f,Y as p,T as u,a as K}from"./BarChart-CG56lHO5.js";import{L as P,a as O}from"./LineChart-BSiQnK8R.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F=C("ArrowUpLeft",[["path",{d:"M7 17V7h10",key:"11bw93"}],["path",{d:"M17 17 7 7",key:"2786uv"}]]),Y=()=>{const d=S(),o=A(),w=R(o),j=I(o),[i,k]=l.useState({openWorkOrders:0,inspections:0,partRequests:0,emergency:0}),[v,c]=l.useState(!0);l.useEffect(()=>{y()},[]);const y=async()=>{c(!0);try{const{count:r}=await n.from("work_orders").select("id",{count:"exact",head:!0}).neq("status","FINISHED"),{count:t}=await n.from("part_requests").select("id",{count:"exact",head:!0}).eq("status","PENDING"),{count:a}=await n.from("work_orders").select("id",{count:"exact",head:!0}).eq("work_type","REPAIR").in("priority",["URGENT","CRITICAL"]).neq("status","FINISHED"),{count:s}=await n.from("pm_plans").select("id",{count:"exact",head:!0}).like("next_run_date",`%${o}%`);k({openWorkOrders:r||0,partRequests:t||0,emergency:a||0,inspections:s||0})}catch(r){console.error("Error fetching stats:",r)}finally{c(!1)}},N=[{label:"دستورکارهای باز",val:i.openWorkOrders,gradient:"bg-gradient-to-br from-orange-400 to-orange-500",shadow:"shadow-orange-500/20",icon:D,path:"/work-orders?status=OPEN"},{label:"برنامه نت امروز",val:i.inspections,gradient:"bg-gradient-to-br from-cyan-400 to-cyan-600",shadow:"shadow-cyan-500/20",icon:E,path:"/pm-scheduler"},{label:"درخواست قطعه باز",val:i.partRequests,gradient:"bg-gradient-to-br from-emerald-400 to-emerald-500",shadow:"shadow-emerald-500/20",icon:z,path:"/part-requests"},{label:"خرابی‌های اضطراری",val:i.emergency,gradient:"bg-gradient-to-br from-rose-400 to-red-500",shadow:"shadow-rose-500/20",icon:T,path:"/work-orders?priority=CRITICAL"}];return e.jsxs("div",{className:"space-y-6 pb-20",children:[e.jsx("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-end gap-4 border-b border-gray-200 dark:border-gray-700 pb-4",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-black text-gray-800 dark:text-white mb-1",children:"داشبورد مدیریتی"}),e.jsx("p",{className:"text-sm text-gray-500",children:"خلاصه وضعیت عملیات کارخانه در یک نگاه"})]})}),e.jsxs("div",{className:"flex flex-col lg:flex-row gap-6 items-stretch",children:[e.jsx("div",{className:"w-full lg:w-96 flex-shrink-0",children:e.jsxs("div",{onClick:()=>d("/work-calendar"),role:"button",tabIndex:0,onKeyDown:r=>r.key==="Enter"&&d("/work-calendar"),className:"bg-white dark:bg-gray-800 rounded-2xl shadow-sm border border-gray-100 dark:border-gray-700 overflow-hidden flex flex-col group transition-all hover:shadow-md h-full cursor-pointer",children:[e.jsxs("div",{className:"bg-gradient-to-br from-[#800020] to-rose-600 p-6 text-white flex justify-center items-center relative overflow-hidden",children:[e.jsx("div",{className:"absolute -right-4 -top-9 opacity-10 transform rotate-12 transition-transform duration-500 group-hover:scale-110",children:e.jsx(x,{className:"w-40 h-40"})}),e.jsxs("div",{className:"relative z-10 text-center",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 mb-2",children:[e.jsx("div",{className:"p-1.5 rounded-lg bg-white/20 backdrop-blur-md border border-white/30 shadow-inner",children:e.jsx(x,{className:"w-4 h-4 text-white"})}),e.jsx("h3",{className:"text-2xl font-black",children:w})]}),e.jsx("p",{className:"text-xl font-bold font-sans opacity-90 tracking-wide",style:{fontFamily:"Vazirmatn, Tahoma, sans-serif"},children:m(o)})]})]}),e.jsx("div",{className:"p-4 flex-1 flex flex-col justify-evenly gap-3",children:["A","B","C"].map(r=>{const t=j[r],a=(t==null?void 0:t.type)||"";let s={icon:M,style:"bg-gradient-to-br from-emerald-100 to-emerald-200 dark:from-emerald-900/40 dark:to-emerald-900/10 border-emerald-200 dark:border-emerald-800 text-emerald-900 dark:text-emerald-100"};a.startsWith("DAY")?s={icon:L,style:"bg-gradient-to-br from-amber-100 to-amber-200 dark:from-amber-900/40 dark:to-amber-900/10 border-amber-200 dark:border-amber-800 text-amber-900 dark:text-amber-100"}:a.startsWith("NIGHT")&&(s={icon:W,style:"bg-gradient-to-br from-indigo-100 to-indigo-200 dark:from-indigo-900/40 dark:to-indigo-900/10 border-indigo-200 dark:border-indigo-800 text-indigo-900 dark:text-indigo-100"});const h=s.icon;return e.jsxs("div",{className:`relative overflow-hidden p-3 rounded-2xl border transition-all hover:scale-[1.02] hover:shadow-md ${s.style}`,children:[e.jsx("div",{className:"relative z-10 flex items-center justify-center gap-4",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("div",{className:"p-1.5 rounded-lg bg-white/30 dark:bg-white/10 backdrop-blur-md border border-white/50 dark:border-white/20 shadow-sm",children:e.jsx(h,{className:"w-3.5 h-3.5"})}),e.jsxs("span",{className:"text-xs font-bold opacity-80 uppercase tracking-wider",children:["شیفت ",r]})]}),e.jsx("span",{className:"text-lg font-black tracking-tight leading-none",children:t==null?void 0:t.label})]})}),e.jsx("div",{className:"absolute top-2 -right-0 opacity-40 transform rotate-12 pointer-events-none",children:e.jsx(h,{className:"w-16 h-16 text-white"})})]},r)})})]})}),e.jsx("div",{className:"flex-1 w-full grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-1 gap-4",children:N.map((r,t)=>e.jsxs("div",{onClick:()=>d(r.path),className:`relative overflow-hidden p-5 rounded-2xl shadow-lg transition-all hover:-translate-y-1 hover:shadow-xl cursor-pointer ${r.gradient} ${r.shadow} group`,children:[e.jsxs("div",{className:"relative z-10",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("p",{className:"text-4xl font-black text-white tracking-tight",children:v?"...":m(r.val)}),e.jsx("div",{className:"bg-white/20 p-2 rounded-full opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(F,{className:"w-5 h-5 text-white"})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-1.5 rounded-lg bg-white/20 backdrop-blur-md border border-white/30 shadow-inner",children:e.jsx(r.icon,{className:"w-4 h-4 text-white"})}),e.jsx("p",{className:"text-sm text-white/90 font-bold opacity-90",children:r.label})]})]}),e.jsx("div",{className:"absolute -top-4 -right-4 opacity-10 rotate-12 transition-transform duration-500 group-hover:scale-110 group-hover:rotate-6",children:e.jsx(r.icon,{className:"w-32 h-32 text-white"})}),e.jsx("div",{className:"absolute top-0 right-0 -mt-4 -mr-4 w-24 h-24 bg-white opacity-10 blur-3xl rounded-full"})]},t))})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 pt-4",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-2xl shadow-sm border border-gray-100 dark:border-gray-700",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-700 dark:text-gray-200 mb-6",children:"توقفات تجهیزات (دقیقه)"}),e.jsx("div",{className:"h-72 w-full min-h-[300px]",children:e.jsx(g,{width:"100%",height:"100%",children:e.jsxs($,{data:_,margin:{left:-15,right:10,top:5,bottom:5},children:[e.jsx(b,{strokeDasharray:"3 3",stroke:"#e5e7eb",vertical:!1}),e.jsx(f,{dataKey:"name",stroke:"#9ca3af",fontSize:11,tickMargin:10}),e.jsx(p,{stroke:"#9ca3af",fontSize:11,tick:({x:r,y:t,payload:a})=>e.jsx("g",{transform:`translate(${r-25}, ${t+4})`,children:e.jsx("text",{textAnchor:"end",fontSize:11,x:0,y:0,children:(a==null?void 0:a.value)??a})})}),e.jsx(u,{cursor:{fill:"transparent"},contentStyle:{borderRadius:"12px",border:"none",boxShadow:"0 10px 15px -3px rgba(0, 0, 0, 0.1)",fontFamily:"inherit"}}),e.jsx(K,{dataKey:"value",fill:"#800020",radius:[6,6,0,0],barSize:40})]})})})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-2xl shadow-sm border border-gray-100 dark:border-gray-700",children:[e.jsx("h3",{className:"text-lg font-bold mb-6 text-gray-700 dark:text-gray-200",children:"روند درخواست‌ها"}),e.jsx("div",{className:"h-72 w-full min-h-[300px]",children:e.jsx(g,{width:"100%",height:"100%",children:e.jsxs(P,{data:q,margin:{left:-15,right:10,top:5,bottom:5},children:[e.jsx(b,{strokeDasharray:"3 3",stroke:"#e5e7eb",vertical:!1}),e.jsx(f,{dataKey:"name",stroke:"#9ca3af",fontSize:11,tickMargin:10}),e.jsx(p,{stroke:"#9ca3af",fontSize:11,tick:({x:r,y:t,payload:a})=>e.jsx("g",{transform:`translate(${r-25}, ${t+4})`,children:e.jsx("text",{textAnchor:"end",fontSize:11,x:0,y:0,children:(a==null?void 0:a.value)??a})})}),e.jsx(u,{contentStyle:{borderRadius:"12px",border:"none",boxShadow:"0 10px 15px -3px rgba(0, 0, 0, 0.1)",fontFamily:"inherit"}}),e.jsx(O,{type:"monotone",dataKey:"uv",stroke:"#38bdf8",strokeWidth:3,dot:{r:4,fill:"#38bdf8",strokeWidth:2,stroke:"#fff"},activeDot:{r:6}})]})})})]})]})]})};export{Y as Dashboard,Y as default};
